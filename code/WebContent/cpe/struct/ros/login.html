<!--
节点login.html文件
请直接替换ROS hotspot默认的login.html
//-->
<!DOCTYPE>
<html>
<head>
<title>login</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="expires" content="-1" />
</head>

<body>
<!-- $(if chap-id) //-->
	<script type="text/javascript" src="/md5.js"></script>
	<script type="text/javascript">
	<!--
	var $_GET = (function(){
		var dst, url,
			s = window.document.location.href.toString().split("&dst=");
		//the dst param in href is unencoded, so we need to truncat it by "&dst="
		url = s[0];
		dst = s[1];
		
		//document.write("url = " + url + "<br/>");
		//document.write("dst = " + dst + "<br/>");
		
		var u = url.split("?");
		if(typeof(u[1]) == "string"){
			u = u[1].split("&");
			var get = {};
			for(var i in u){
				if(u.hasOwnProperty(i)){
					var j = u[i].split("=");
					get[j[0]] = j[1];
				}
			}
			
			if(dst){
				get["dst"] = encodeURIComponent(dst);
			}
			
			return get;
		} else {
			return {};
		}
	})();
	window.onload =function(){
		if($_GET["chaplogin"]=="true"){
			location.href="$(link-login-only)?&popup=false&username=" + $_GET["username"] + "&password="+ hexMD5("$(chap-id)" + $_GET["password"] + "$(chap-challenge)") +"&dst=" + $_GET["dst"];
		}else{
			location.href="http://120.24.77.206/softac/wifiant/login/?key=d785c76cc0c27d8816f7cbd08daf7119&chap=true&login=$(link-login-only)&stamac=$(mac)&intf=0&url=$(link-orig-esc)";
		};
	}
	//-->
	</script>
	<br>
<!-- $(else) //-->
	<script type="text/javascript">
	<!--
	var $_GET = (function(){
		var dst, url,
			s = window.document.location.href.toString().split("&dst=");
		//the dst param in href is unencoded, so we need to truncat it by "&dst="
		url = s[0];
		dst = s[1];
		
		//document.write("url = " + url + "<br/>");
		//document.write("dst = " + dst + "<br/>");
		
		var u = url.split("?");
		if(typeof(u[1]) == "string"){
			u = u[1].split("&");
			var get = {};
			for(var i in u){
				if(u.hasOwnProperty(i)){
					var j = u[i].split("=");
					get[j[0]] = j[1];
				}
			}
			
			if(dst) get["dst"] = encodeURIComponent(dst);
			
			return get;
		} else {
			return {};
		}
	})();
	window.onload =function(){
		if($_GET["chaplogin"]=="false"){
			location.href="$(link-login-only)?&popup=false&username=" + $_GET["username"] + "&password="+  $_GET["password"] +"&dst=" + $_GET["dst"];
		}else{
			location.href="http://120.24.77.206/softac/wifiant/login/?key=d785c76cc0c27d8816f7cbd08daf7119&chap=false&login=$(link-login-only)&stamac=$(mac)&intf=0&url=$(link-orig-esc)";
		};
	}
	//-->
	</script>
<!-- $(endif) //-->  
</body>
</html>
