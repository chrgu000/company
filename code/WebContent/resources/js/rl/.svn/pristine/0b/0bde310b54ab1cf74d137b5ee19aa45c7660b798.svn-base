orderjs.define("x:mti.treeNavPage",["lib.data.XJSON","lib.rpc.engine","gui.box.Box","gui.Iframe","gui.tree.Tree","gui.menu.PopupMenu","app.opoa.page","x:mti.readRequestDataErrHandler"],function(){var e=rl.getG11nSource("rlx.mti.treeNavPage")||{};rl.createNamespace("rlx.mti.treeNavPage"),rl.page.on("subpagepropertychange",function(e,r,n){if(rl.isNonNullStr(r)){if(r=r.toLowerCase(),"icon"==r){var t=rl.page.defaultPageIcon||"",a=rlx.mti.subpageCategoryIcon;String(n)===t&&rl.isNonNullStr(a)&&(n=a)}else"status"===r&&(rl.debug("value = "+n),"unload"===n||"init"===n?(n=rl.page.defaultPageLoadingIcon,r="icon"):"load"===n&&(n=a,r="icon"));var o="set"+r.capitalize();n&&rl.isFunction(rl.page[o])&&rl.page[o](n)}});var r=rlx.mti.config,n=rlx.mti.treeNavPage.mainFrame=new rl.gui.Iframe({contentWindowListener:function(){var e,r=n.getContentWindow();if(r)try{e=!!r.rl}catch(t){}e||rl.page.setIcon(rl.page.defaultPageIcon)}}),t=rlx.mti.treeNavPage.menuTree=new rl.Tree({autoPrefixId:!1,iniOpenTo:r.menuTreeIniOpenTo,iconRoot:r.menuTreeIconRoot,actionDataRoot:r.menuTreeActionDataRoot,deferRenderNodes:!1,orderBranchesFirst:!1,autoRenderOnReady:!1,lazyRender:!0,dataSource:null,contextmenu:new rl.gui.menu.PopupMenu({items:[{text:rl.getG11nSource("open")||"open",action:function(){var e=t.cus_contextNode;rl.debug("item = "+e),e&&t.openTo(e)}},{text:rl.getG11nSource("openAtNewTab")||"open at new tab",action:function(){var e,r,n=t.cus_contextNode;n&&(r=e=rl.rpc.appendUrlRandom(n.actionData,null),rl.page.open(r,e))}}]}),action:function(e,r){var a=r.actionData;if(rl.isNonNullStr(a)){var o=t.actionDataRoot,i=a.contains("://")||a.startsWith("/")?a:o+(o.endsWith("/")?"":"/")+a;i=rl.rpc.appendUrlRandom(i,null),n.open(i),rl.page.setTitle(r.text),rl.page.setIcon(rl.page.defaultPageLoadingIcon),rlx.mti.subpageCategoryIcon=r.icon}},xjsonItemName:"item"});t.on("render",function(){t.dw.on("contextmenu",function(e){var r=this.contextmenu;r.showAtEvent(e),rl.ew.stopDefault(),t.cus_contextNode=t.getNodeByEvent(e)},t)}),rl.onReady(function(){var a=new rl.rpc.XHRequest({url:r.urlOfMenuTree,responseType:"xml",method:"get",async:!0,successHandler:function(r,a){var o=rl.toXjson(r);if(rl.debug(this+" ds = "+o),!r||9===r.nodeType){var i,l=a.responseText;return i=(e.loadMenuDataError||"Error loading data:")+"\n"+((String.isHtml(l)?rlx.mti.readErrRsp(l).msg:"")||e.serverMenuDataHandlerError||"Server error!"),void alert(i)}t.dataSource=o,rl.layoutBody({west:{iniSize:200,comp:t},center:{comp:n}})},failureHandler:function(){alert((e.loadMenuDataError||"Error loading data:")+rlx.mti.failureRequestMsg)}});a.request()})});