orderjs.define("gui.form.Combox",["gui.engine","gui.form.Input","css>rl:inputs"],function(){rl.gui.form.Option=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.form.Option.parent.call(this,t),this.dw=new rl.dom.DomWrap)},members:{text:"",value:void 0,render:function(t){if(this._rendered)return this;t=this.getRenderTarget(t);var e=new Option(this.text,this.value);return t.options[t.options.length]=e,this.dw.setTarget(e),this._rendered=!0,this.fireEvent("render"),this},updateSelectedView:function(){this.dw.dom.selected=!0},toString:function(){return"[object rl.gui.form.Option]"}}}),rl.gui.ctype2Classes.add("option",rl.gui.form.Option),rl.gui.form.Combox=rl.createClass({parent:rl.gui.form.Input,construct:function(t){rl.isPrototyping(arguments[0])||rl.gui.form.Combox.parent.call(this,t)},members:{selectedIndex:0,css:"",width:"auto",labelCss:"",ctrlCss:"",itemType:rl.gui.form.Option,_htmlTpl:new rl.HtmlTpl('<span class="rl_input {css}" id="{id}"><label for="{ctrlId}" class="{labelCss}">{label}<select id="{ctrlId}" class="{ctrlCss}" name="{name}" style="width:{width};" {disabledState} {readonlyState} /></select></label><span class="annotation">{annotation}</span></span>'),initialize:function(){var t=this.items;this.items=[],this._namedItemsStore={},rl.isArray(t)&&(t=this.initItems(t),this.addItems(t));var e=this.items[this.selectedIndex];e&&(this.value=e.value),rl.gui.form.Combox.parent.prototype.initialize.apply(this,arguments)},initItems:function(t){var e=this.itemType;if(rl.isArray(t))for(var i=0,r=t.length;r>i;i++)t[i]||t.removeAt(i),i--,r--;return Array.map(function(t){return t instanceof rl.gui.ComponentBase?t:new e(t)},t)},initCtrl:function(){var t=rl.getDom(this.ctrlId),e=this.selectedIndex,i=this.getItem(e);rl.$(t).on("change",this.hndCtrlEleChange,this),this._ctrlEle=t,i&&(this.value=void 0===i.value?i.text:i.value)},render:function(t){if(this._rendered)return this;t=this.getRenderTarget(t);var e,i,r,s,n;n=s="",i=rl.isNonNullStr(this.id)?this.id:this.autoId(),r=i+"_ctrl",this.id=i,this.ctrlId=r,this.disabled&&(n=" disabled='disabled' "),this.readonly&&(s=" readonly='readonly' "),e=this._htmlTpl.renderTo(t,{css:this.css+(this.alignRight?" rl_alignright":""),labelCss:this.labelCss,ctrlCss:this.ctrlCss,label:this.label,annotation:this.annotation,id:i,ctrlId:r,name:this.name,width:rl.dom.addUnit(this.width),disabledState:n,readonlyState:s},this.renderPosition),this.dw.setTarget(e),this._renderItems(),this.initCtrl(),this.updateValueListener();var l=this.selectedIndex;return this.selectedIndex=-1,this.select(l),this._rendered=!0,this.fireEvent("render"),this},_renderItems:function(){Array.each(this._renderItem,this.items,this)},_renderItem:function(t){t.appendDomTo(this.ctrlId)},setWidth:function(){return this},select:function(t){if(t=parseInt(t),this.selectedIndex==t||isNaN(t))return this;var e,i=this.getItem(t);return i&&(this.selectedIndex=t,e=void 0===i.value?i.text:i.value,this.setValue(e),rl.isFunction(i.updateSelectedView)&&i.updateSelectedView()),this},addOption:function(t,e){(null===e||void 0===e)&&(e=t);var i=new this.itemType({text:t,value:e});return this.add(i)},afterAdd:function(t){var e=t.owner;e instanceof rl.gui.ContainerBase&&rl.isFunction(e.remove)&&e.remove(t),t.owner=this,this._rendered&&t.appendDomTo(this.ctrlId)},afterRemove:function(t){rl.isFunction(t.removeDom)&&t.removeDom(),this.hndCtrlEleChange()},hndCtrlEleChange:function(){var t=rl.getDom(this.ctrlId);t&&this.select(t.selectedIndex)},toString:function(){return"[object rl.gui.form.Combox]"}}}),rl.fill(rl.gui.form.Combox.prototype,rl.gui.itf.iGrouping),rl.gui.ctype2Classes.add("Combox",rl.gui.form.Combox)});