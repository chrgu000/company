/**
 * @fileOverview util properties and methods for GUI;
 * @change
 	#1 by prcjack Creates file.
 */
orderjs.define("gui.engine",["css>rl:default","lib.data.engine","lib.dom.engine","lib.dom.DomWrap"],function(){var t=new rl.util.PathMapping(rl.mapPath("res/image/default/")),e=new rl.util.PathMapping(t.mapping("button/system/")),i=t.mapping("common/blank.gif"),n=Function.bind(e.mapping,e);rl.ext(rl.gui,{imgPM:t,iconPM:e,URL_BLANK_IMG:i,ctype2Classes:new rl.data.IMap,ctype2Modules:new rl.data.IMap,compStore:new rl.data.IMap,FN_ReturnThis:function(){return this},mapIcon:n,mapImg:Function.bind(t.mapping,t),createComp:function(t){var e,i=rl.gui;if(rl.isObject(t)&&(e=i.getCompType(t.ctype)),!rl.isFunction(e)){var n=this+"createComp(): Invalid config's ctype"+t.ctype+", not loaded nor registered!";throw new Error(n)}if(!t.renderTarget){var r=document.getElementsByTagName("script"),s=r[r.length-1],o=s.parentNode;dw=rl.dw.setTarget(o),dw.isTag("head")||dw.isTag("html")||(t.renderTarget=s,t.renderPosition="beforebegin")}return new e(t)},getCompType:function(t){return rl.gui.ctype2Classes.get(t)},getComp:function(t){return rl.gui.compStore.get(t)},emptySelection:function(){document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},clearTableSpacing:function(t){rl.$(t).isTag("table")&&(t.setAttribute("border",0),t.setAttribute("cellspacing",0),t.setAttribute("cellpadding",0))},autoStopContextmenu:function(t){var e;e=rl.ew.init(t).getTarget(),rl.$(e).isTag("input")||rl.ew.stopDefault()},_noneSelectAll:function(){return!1},_noneSelectAuto:function(t){var e=rl.ew.init(t).getTarget();return rl.$(e).isTag("input")?void 0:!1},makeUnselectable:function(t,e){rl.dw.setTarget(t);if(t=rl.getDom(t),rl.isElement(t))if(rl.GECKO){var i=e?"-moz-none":"none";t.style.MozUserSelect=i}else if(rl.IE||rl.SAFARI){var n=e?"_noneSelectAuto":"_noneSelectAll";t.onselectstart=rl.gui[n]}else t.unselectable="on"}}),rl.createComp=rl.gui.createComp,rl.getComp=rl.gui.getComp,rl.createNamespaces("rl.gui.box","rl.gui.button","rl.gui.dialog","rl.gui.grid","rl.gui.itf","rl.gui.indicator","rl.gui.form","rl.gui.layout","rl.gui.list","rl.gui.menu","rl.gui.panel","rl.gui.tab","rl.gui.tree"),function(){rl.gui.itf.iInteractive={_interactiveMouseTypes:["out","over"],displayStateChangedStyle:function(){this.applyInteractiveStyle("out")},applyInteractiveStyle:function(t){var e=this._getInteractiveStateCss(t);this._isInteractiveStateStyle(e)||(this._cancelInteractiveStyle(),this._setInteractiveStateStyle(e),this._addItemStyle(e))},_isInteractiveStateStyle:function(t){return this._interactiveStateStyle==t},_setInteractiveStateStyle:function(t){this._interactiveStateStyle=t},_getInteractiveStateStyle:function(){return this._interactiveStateStyle},_addItemStyle:function(t){rl.isNonNullStr(t)&&this.dw.addClass(t)},_removeItemStyle:function(t){rl.isNonNullStr(t)&&this.dw.removeClass(t)},_cancelInteractiveStyle:function(){var t=this._interactiveStateStyle;this._removeItemStyle(t),delete this._interactiveStateStyle},_getInteractiveStateCss:rl.EMPTY_FUNCTION,toString:function(){return"[object rl.gui.itf.iInteractive]"}}}(),function(){rl.gui.itf.iControl={getValue:function(){return this.value},setValue:function(t){var e=this.value;return e==t?this:(this.value=t,this.fireEvent("change",t,e),this)},getText:function(){return this.text},setText:function(t){if(void 0===t||null===t)return this;if(t=String(t),!rl.isNonNullStr(t))return this;var e=this.text;return e!=t&&(this._getTextCtn().innerHTML=t,this.text=t,this._updateWidth(),this.autoTip&&this.setTip(t)),this},setTip:function(t){if(void 0===t||null===t)return this;if(t=String(t),!rl.isNonNullStr(t))return this;var e=this.dw.dom;return rl.isElement(e)&&(e.title=t),this},setIcon:function(t){return rl.isNonNullStr(t)&&this.icon!=t?(this.icon=t,this._updateIconView(t),this):this},getIcon:function(){return this.icon},_updateIconView:function(t){if(rl.isNonNullStr(t)){var e=this._getIconCtn();rl.isElement(e)&&(e.style.backgroundImage="url("+t+")")}},show:function(){return this.hidden?(this.dw.dom&&this.dw.show(),this.hidden=!1,this):this},hide:function(){return this.hidden?this:(this.dw.dom&&this.dw.hide(),this.hidden=!0,this)},setVisible:function(t){t?this.show():this.hide()},disable:function(){return this.disabled?this:(this.disabled=!0,this._ctrlEle&&(this._ctrlEle.disabled=!0),this.displayStateChangedStyle(),rl.isNonNullStr(this.disabledIcon)&&this._updateIconView(this.disabledIcon),this)},enable:function(){return this.disabled?(this.disabled=!1,this._ctrlEle&&(this._ctrlEle.disabled=!1),this.displayStateChangedStyle(),rl.isNonNullStr(this.disabledIcon)&&this._updateIconView(this.getIcon()),this):this},setEnable:function(t){t?this.enable():this.disable()},focus:function(){return this.disabled||this.focused?this:this},blur:function(){return this.disabled||!this.focused?this:this},_getTextCtn:rl.EMPTY_FUNCTION,_getIconCtn:rl.EMPTY_FUNCTION,_updateWidth:rl.EMPTY_FUNCTION,toString:function(){return"[object rl.gui.itf.iControl]"}},rl.fill(rl.gui.itf.iControl,rl.gui.itf.iInteractive)}(),function(){rl.gui.itf.iInput={label:"",annotation:"",type:"text",name:"",value:"",id:"",css:"",labelCss:"",ctrlCss:"",readonly:!1,disabled:!1,visible:!0,width:"auto",autoRenderOnReady:!0,validation:null,toString:function(){return"[object rl.gui.itf.iInput]"}}}(),function(){rl.gui.itf.iIndicator={initialize:function(){rl.isNonNullStr(this.id)||(this.id=this.autoId()),this.dw=new rl.dom.DomWrap,this.onInitialize(),Function.defer(this._deferInits,this)},_deferInits:function(){this.autoRenderOnReady&&rl.onReady(Function.bind(this.render,this))},indicate:function(t){if(this.fireEvent("beforeindicate",t)===!1)return!1;var e=this.getContent();return e==t?this:(this.updateContent(t),this.fireEvent("change",t,e)===!1?!1:this)},show:function(){return this.hidden?(this.dw.show(),this.hidden=!1,this.fireEvent("show"),this):this},hide:function(){return this.hidden?this:(this.dw.hide(),this.hidden=!0,this.fireEvent("hide"),this)},getContent:rl.EMPTY_FUNCTION,updateContent:rl.EMPTY_FUNCTION,render:rl.EMPTY_FUNCTION,onInitialize:rl.EMPTY_FUNCTION,toString:function(){return"[object rl.gui.itf.iIndicator]"}}}(),function(){rl.gui.itf.iSelectable={select:function(){return this.selected?this:(this.selected=!0,this.owner&&rl.isFunction(this.owner.afterItemSelectChange)&&this.owner.afterItemSelectChange(this,!0),rl.isFunction(this.afterSelectChange)&&this.afterSelectChange(),this.displayStateChangedStyle(),this)},unSelect:function(){return this.selected?(this.selected=!1,this.owner&&rl.isFunction(this.owner.afterItemSelectChange)&&this.owner.afterItemSelectChange(this,!1),rl.isFunction(this.afterSelectChange)&&this.afterSelectChange(),this.displayStateChangedStyle(),this):this},toggleSelect:function(){return this.selected?this.unSelect():this.select()},displayStateChangedStyle:rl.EMPTY_FUNCTION,toString:function(){return"[object rl.gui.itf.iSelectable]"}}}(),function(){rl.gui.itf.iGrouping={add:function(t,e){if(this.beforeAdd(t,e)===!1)return null;var i=this.getItems();return rl.isArray(i)?(rl.isNonNullStr(e)&&this._regNamedItem(t,e),i.push(t),this.afterAdd(t,e),t):null},addItems:function(t){return Array.each(this.add,t,this),this},insertAt:function(t,e,i){if(isNaN(e))return this.add(t,i);if(this.beforeAdd(t,i)===!1)return null;var n=this.getItems();if(!rl.isArray(n))return null;var r=n.length;if(-1>e)e=0;else if(e>=r)return this.add(t,i);return rl.isNonNullStr(i)&&this._regNamedItem(t,i),n.insertAt(t,e),this.afterAdd(t,i,e),t},insertItems:function(t,e){Array.each(function(t,i){this.insertAt(t,e+i)},t,this)},remove:function(t,e){if(this.beforeRemove(t,e)===!1)return null;var i=this.getItems();return rl.isArray(i)?(t=i.remove(t))?(this.afterRemove(t,e),rl.isNonNullStr(e)&&this._unregNamedItem(e),t):null:null},removeAt:function(t){var e=this.getItems();if(!rl.isArray(e))return null;var i=e.removeAt(t);return i?(rl.isFunction(this.afterRemove)&&this.afterRemove(i),i):null},beforeAdd:rl.EMPTY_FUNCTION,afterAdd:rl.EMPTY_FUNCTION,beforeRemove:rl.EMPTY_FUNCTION,afterRemove:rl.EMPTY_FUNCTION,indexOfItemId:function(t){return this.indexOf(function(e){return e.id==t})},getItem:function(t){var e=this.getItems();if(!rl.isArray(e))return null;var i=null;return rl.isNonNullStr(t)&&(i=this._getNamedItem(t)),i||isNaN(t)||(i=e[t]),i},getItemByEvent:function(t){var e=rl.ew.init(t).getTarget();return this.getItemByEle(e)},getItemByEle:function(t){return rl.isElement(t)&&(t=rl.dom.findParentBy(t,this._isItemEle,this),rl.isElement(t))?this.find(function(e){return e.dw.dom===t}):void 0},getItemById:function(t){if(rl.isNonNullStr(t)){var e=this.indexOfItemId(t),i=this.getItems()||[];return i[e]}},getPreviousItem:function(t){var e=this.items,i=e.indexOf(t);return i>-1?e[i-1]:void 0},getNextItem:function(t){var e=this.items,i=e.indexOf(t);return i>-1?e[i+1]:void 0},getItems:function(){return this.items},getNamedItemStore:function(){return this._namedItemsStore},_getNamedItem:function(t){var e=this.getNamedItemStore();return rl.isObject(e)&&rl.isNonNullStr(t)?e[t]:null},_getItemIdByItemEle:function(t){return rl.isElement(t)?t.id:void 0},_isItemEle:function(t){try{return t.parentNode==this._getItemsCtn()}catch(e){}},_getItemsCtn:function(){return this.dw.dom},_regNamedItem:function(t,e){var i=this.getNamedItemStore();return rl.isObject(i)&&rl.isNonNullStr(e)?void(i[e]=t):null},_unregNamedItem:function(t){var e=this.getNamedItemStore();return rl.isObject(e)&&rl.isNonNullStr(t)?void delete e[t]:null},each:function(t,e,i){return Array.each(t,this.getItems(),e||this,i)},indexOf:function(t,e,i){return Array.indexOf(t,this.getItems(),e||this,i)},find:function(t,e,i){return Array.find(t,this.getItems(),e||this,i)},filter:function(t,e,i){return Array.filter(t,this.getItems(),e||this,i)},map:function(t,e,i){return Array.map(t,this.getItems(),e||this,i)},toString:function(){return"[object rl.gui.itf.iGrouping]"}}}(),function(){rl.gui.itf.iItemsSelectable={selectItem:function(t){if(isNaN(t)){if(!this.getItems().contains(t))return this}else t=this.getItems()[t];return t&&rl.isFunction(t.select)&&t.select(),this},unSelectItem:function(t){return isNaN(t)||(t=this.getItems()[t]),t&&rl.isFunction(t.unSelect)&&t.unSelect(),this},toggleSelectItem:function(t){return isNaN(t)||(t=this.getItems()[t]),t&&rl.isFunction(t.toggleSelect)&&t.toggleSelect(),this},selectSingle:function(t){return this.unSelectAllExcept(t),this.selectItem(t),this},selectAll:function(){return this.each(function(t){this.selectItem(t)}),this},unSelectAll:function(){return this.each(this.unSelectItem),this},unSelectAllExcept:function(t){return this.each(function(e){t!=e&&this.unSelectItem(e)}),this},inverseSelectAll:function(){return this.each(this.toggleSelectItem),this},isAllSelected:function(){var t=this.getSelectedItems(),e=this.getItems();return e&&t&&t.length>0&&e.length==t.length},getSelectedItems:function(){return this._selectedItems},getSelectedItemsDataIdList:function(){var t=this.getDataSourceIdFieldName();return rl.isNonNullStr(t)?Array.map(function(e){var i=e.dataSource;return i&&rl.isFunction(i.getValue)?i.getValue(t):void 0},this.getSelectedItems(),this):[]},getItems:function(){return this.items},getDataSourceIdFieldName:rl.EMPTY_FUNCTION,afterItemSelectChange:function(t,e){var i=this.getSelectedItems();return e?i.contains(t)||i.push(t):i.remove(t),this.checkAllSelectedState(),this},checkAllSelectedState:function(){rl.isFunction(this.afterAllSelectStateChange)&&this.afterAllSelectStateChange(this.isAllSelected())},toString:function(){return"[object rl.gui.itf.iItemsSelectable]"}}}(),function(){rl.gui.ComponentBase=rl.createClass({parent:rl.util.EventProvider,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.ComponentBase.parent.call(this,t),rl.ext(this,t))},members:{autoIdPrefix:"rl_comp_",renderPosition:"beforeend",dw:void 0,autoId:function(){return rl.autoId(this.autoIdPrefix)},getHeight:function(){return this.dw.getHeight()},getWidth:function(){return this.dw.getWidth()},setHeight:function(t){return this.height=t,this.dw.setHeight(t),this},setWidth:function(t){return this.width=t,this.dw.setWidth(t),this},getRenderTarget:function(t){return t=rl.getDom(t),rl.isElement(t)||(t=rl.getDom(this.renderTarget)),rl.isElement(t)||(t=document.body),t},appendDomTo:function(t,e){try{this._rendered?(t=rl.getDom(t),rl.isElement(t)&&(rl.isNonNullStr(e)?rl.dom.insertElements(e,this.dw.dom,t):t.appendChild(this.dw.dom))):(this.renderTarget=t,rl.isNonNullStr(e)&&(this.renderPosition=e),this.render(t))}catch(i){throw rl.debug(this+" this.render = "+this.render),rl.dir(i),i}},removeDom:function(){var t=this.dw.dom;rl.isElement(t)&&t.parentNode&&t.parentNode.removeChild(t)},dispose:function(){return this._disposed?this:this.fireEvent("beforedispose")===!1?this:(rl.isFunction(this.onDispose)&&this.onDispose(),this._disposed=!0,this.fireEvent("dispose"),this)},toString:function(){return"[object rl.gui.ComponentBase]"}}})}(),function(){rl.gui.ControlBase=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){rl.isPrototyping(arguments[0])||rl.gui.ControlBase.parent.call(this,t)},members:{text:"",tip:"",value:void 0,disabled:!1,hidden:!1,focused:!1,_interactiveMouseTypes:["out","over"],_getTextCtn:rl.EMPTY_FUNCTION,_updateWidth:rl.EMPTY_FUNCTION,toString:function(){return"[object rl.gui.ControlBase]"}}}),rl.fill(rl.gui.ControlBase.prototype,rl.gui.itf.iControl)}(),function(){rl.gui.ContainerBase=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){rl.isPrototyping(arguments[0])||rl.gui.ContainerBase.parent.call(this,t)},members:{getItemType:function(t){if(rl.isNonNullStr(t)){var e=rl.gui.getCompType(t);if(rl.isFunction(e)&&e.prototype instanceof rl.gui.ComponentBase)return e;rl.debug(this+" -> getItemType(): Invalid ctype = "+t,"warn")}return this.itemType},toString:function(){return"[object rl.gui.ContainerBase]"}}}),rl.fill(rl.gui.ContainerBase.prototype,rl.gui.itf.iGrouping)}(),function(){rl.gui.floaterShimPool=function(){function t(){return rl.dom.insertHtml("afterbegin",i,document.body)}var e=[],i='<iframe class="rl_popup_mask" frameborder="0" scrolling="no" src="about:blank"></iframe>';return{pull:function(){return e.shift()||new rl.DomWrap(t())},push:function(t){e.push(t)},toString:function(){return"[object rl.gui.floaterShimPool]"}}}(),rl.gui.enableFloaterShim=rl.IE&&rl.VER_IE<7}(),function(){rl.gui.Shadow=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){return rl.isPrototyping(arguments[0])?void 0:(rl.gui.Shadow.parent.call(this,t),rl.ext(this,t),this.initialize(),this)},members:{offset:4,sides:"rb",_enableFloaterShim:rl.IE&&rl.VER_IE<7,initialize:function(){rl.isNonNullStr(this.sides)||(this.sides=rl.gui.Shadow.defaultSides);var t=this.adjusts={h:0,w:0,l:0,t:0},e=this.offset,i=this.sides.toLowerCase(),n={};i.replace(/[trbl]/g,function(t){n[t]=!0}),n.t&&(t.t-=e,t.h+=e),n.r&&(n.l?t.w+=e:t.l+=e),n.b&&(n.t?t.h+=e:t.t+=e),n.l&&(t.l-=e,t.w+=e),this._enableFloaterShim&&(this._shimAdjusts={l:Math.min(t.l,0),t:Math.min(t.t,0),w:Math.max(t.w,0),h:Math.max(t.h,0)})},show:function(t,e,i,n,r){this.dw||(this.dw=rl.gui.Shadow.DomPool.pull(),this.dw.dom.nextSibling!=t.dom&&rl.dom.insertElements("beforeBegin",this.dw.dom,t.dom)),rl.isEmpty(e)&&(e=t.getLeft(!0)),rl.isEmpty(i)&&(i=t.getTop(!0)),n>0||(n=t.getWidth()),r>0||(r=t.getHeight()),this.setZIndex(t.getZIndex(!0)-1),this.alignTo(e,i,n,r),this.dw.show(),this._enableFloaterShim&&this._showFloaterShim(t,e,i,n,r)},hide:function(){this.dw.hide(),rl.gui.Shadow.DomPool.push(this.dw),delete this.dw,this._enableFloaterShim&&this._hideFloaterShim()},alignTo:function(t,e,i,n){if(this.dw){var r=this.adjusts,s=this.dw.dom,o=s.firstChild,l=s.style,a=2*rl.gui.Shadow.frameWidth;if(t=parseInt(t),e=parseInt(e),i=parseInt(i),n=parseInt(n),rl.isNumber(t)&&(l.left=t+r.l+"px"),rl.isNumber(e)&&(l.top=e+r.t+"px"),rl.isNumber(i)){var u=i+r.w;if(this.dw.setWidth(u),i+"px"!=l.width){var h=o.rows[0].cells[1];rl.$(h).setWidth(Math.max(0,u-a))}}if(rl.isNumber(n)){var d=n+r.h;if(this.dw.setHeight(d),n+"px"!=l.height){var c=o.rows[1].cells[1];rl.$(c).setHeight(Math.max(0,d-a))}}this._enableFloaterShim&&this._alignFloaterShim(t,e,i,n)}},setZIndex:function(t){this.dw&&(this.dw.setZIndex(t),this._enableFloaterShim&&this._FloaterShim&&this._FloaterShim.setZIndex(t-1))},_showFloaterShim:function(t,e,i,n,r){this._FloaterShim||(this._FloaterShim=rl.gui.floaterShimPool.pull()),this._alignFloaterShim(e,i,n,r),this._FloaterShim.setZIndex(this.dw.getZIndex(!0)-1).show()},_hideFloaterShim:function(){this._FloaterShim&&(this._FloaterShim.hide(),rl.gui.floaterShimPool.push(this._FloaterShim),delete this._FloaterShim)},_alignFloaterShim:function(t,e,i,n){if(this._FloaterShim){var r=(this.dw,this._shimAdjusts),s=this._FloaterShim.dom.style;t=parseInt(t),e=parseInt(e),i=parseInt(i),n=parseInt(n),rl.isNumber(t)&&(s.left=t+r.l),rl.isNumber(e)&&(s.top=e+r.t),rl.isNumber(i)&&(s.width=i+r.w),rl.isNumber(n)&&(s.height=n+r.h)}},onDispose:function(){this.hide()},toString:function(){return"[object rl.gui.Shadow]"}}}),rl.ext(rl.gui.Shadow,{frameWidth:8,_floaterShimZIndex:8,defaultSides:"rb"}),rl.gui.Shadow.DomPool=function(){function t(){return n?n.cloneNode(!0):(n=rl.dom.insertHtml("afterbegin",l,document.body),o&&Array.each(e,n.firstChild.rows),n)}function e(t){Array.each(i,t.cells)}function i(t){var e=s[t.className];rl.isNonNullStr(e)&&(t.style.filter=e)}var n,r=[],s={},o=rl.IE&&rl.VER_IE<7,l='<div class="rl_shadow"><table class="wrapper" border="0" cellspacing="0" cellpadding="0"><tr><td class="shd_nw">&nbsp;</td><td class="shd_n">&nbsp;</td><td class="shd_ne">&nbsp;</td></tr><tr><td class="shd_w">&nbsp;</td><td class="shd_c">&nbsp;</td><td class="shd_e">&nbsp;</td></tr><tr><td class="shd_sw">&nbsp;</td><td class="shd_s">&nbsp;</td><td class="shd_se">&nbsp;</td></tr></table></div>';if(o){var a='progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src="'+rl.gui.mapImg("common/{file}")+'")';Array.each(function(t){var e="shadow_"+t+".png";s["shd_"+t]=a.replace(/{file}/,e)},"nw n ne e se s sw w".split(" "))}return{_cellFilters:s,pull:function(){return r.shift()||new rl.DomWrap(t())},push:function(t){r.push(t)},toString:function(){return"[object rl.gui.Shadow.DomPool]"}}}()}(),function(){rl.gui.popupMgr={baseZIndex:2e3,defaultShadowOffset:4,defaultShadowSides:"rb",_showingPopups:[],initialize:function(){var t=rl.dom,e=t.getPageFocusInEvent();e&&rl.isFunction(e.addHandler)&&(e.addHandler(this.hndPageFocusIn,this),t._attachEvent(window,"unload",Function.bind(function(){e.removeHandler(this.hndPageFocusIn,this),t._detachEvent(window,"unload",arguments.callee)},this)))},regShowingPopup:function(t){t&&!this._showingPopups.contains(t)&&this._showingPopups.push(t)},unRegShowingPopup:function(t){this._showingPopups.remove(t)},hndPageFocusIn:function(){var t=this._showingPopups;if(0!=t.length){rl.ew.init();var e=rl.ew.getEvt();(!e||this.canHidePopups(rl.ew.getTarget()))&&this.hideAllPopup()}},hideAllPopup:function(){for(var t,e=this._showingPopups;t=e.shift();)rl.isFunction(t.hide)&&t.hide()},canHidePopups:function(t){return Array.every(function(e){return e.canHide(t)},this._showingPopups)},toString:function(){return"[object rl.gui.popupMgr]"}},rl.gui.popupMgr.initialize()}(),function(){rl.gui.itf.iShadow={initShadow:function(){this.shadow||(this.shadow=this.createShadow())},createShadow:function(){var t=rl.gui.popupMgr;return new rl.gui.Shadow({offset:t.defaultShadowOffset,sides:t.defaultShadowSides})},showShadow:function(){if(this.shadow){var t=this.dw.dom,e=t.style,i=t.offsetWidth,n=t.offsetHeight,r=e.left,s=e.top;this.shadow.show(this.dw,r,s,i,n)}},hideShadow:function(){this.shadow&&this.shadow.hide()},toString:function(){return"[object rl.gui.itf.iShadow]"}}}(),function(){rl.gui.PopupWrap=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){return rl.isPrototyping(arguments[0])?void 0:(rl.gui.PopupWrap.parent.call(this,t),rl.ext(this,t),this.initialize(),this)},members:{owner:null,target:null,hidden:!0,useShadow:!0,iniVisible:!1,initialize:function(){this.target&&this.setTarget(this.target),this.useShadow&&this.initShadow()},setTarget:function(t){if(this.initTarget(t),this.target=t,this.dw=t.dw,rl.config.debugMode&&!(t instanceof rl.gui.ComponentBase)){var e=this+"-> setTarget(): Invalid target: "+t;rl.debug(e,"warn")}return this},removeTarget:function(){return delete this.target,delete this.dw,this},initTarget:function(t){t.show||(t.show=Function.bind(t.dw.show,t.dw)),t.hide||(t.hide=Function.bind(t.dw.hide,t.dw)),t.dw.setStyle({position:"absolute"})},show:function(){var t=this.owner,e=this.target;if(!(t&&e&&this.hidden))return this;var i=rl.gui.popupMgr;return e.dw.alignTo(rl.$(t._ctrlEle),"be",!0),e.dw.setZIndex(i.baseZIndex),e.show(),this.useShadow&&this.showShadow(),i.regShowingPopup(this),this.hidden=!1,this.fireEvent("show"),this},showAt:function(t,e,i){return this.dw.setXY(t,e,i),this.hidden?this.show():this.showShadow(),this},hide:function(){var t=this.target;if(!t||this.hidden)return this;var e=rl.gui.popupMgr;return t.hide(),this.useShadow&&this.hideShadow(),e.unRegShowingPopup(this),this.hidden=!0,this.fireEvent("hide"),this},canHide:function(t){return this.target&&!this.target.dw.within(t)},onDispose:function(){this.hidden||this.hide(),this.removeTarget(),delete this.owner,this.shadow&&(this.shadow.dispose(),delete this.shadow)},toString:function(){return"[object rl.gui.PopupWrap]"}}}),rl.fill(rl.gui.PopupWrap.prototype,rl.gui.itf.iShadow)}(),function(){rl.gui.LayerStack=rl.createClass({construct:function(t){rl.isPrototyping(arguments[0])||this.initialize(t)},members:{baseZIndex:10,layers:null,initialize:function(t){this.initConfig(t),this.layers=[]},add:function(t){if(!this._isValidLayer(t))return this;var e=this.layers;return e.contains(t)||(e.push(t),this.update()),this},remove:function(t){var e=this.layers,i=e.indexOf(t);return i>-1&&(e.removeAt(i),this.update()),this},update:function(){var t=this.baseZIndex,e=rl.gui.popupsSpacing;return Array.each(function(i,n){i.setZIndex(t+n*e),rl.debug(this+" update(): (base + index * spacing) = "+(t+n*e))},this.layers,this),this},bringFrontest:function(t){var e=this.layers,i=e.indexOf(t);return i>-1&&i!==e.length-1&&(e.removeAt(i),e.push(t),this.update()),this},cfg:function(t,e){var i=this._config;if(i)return arguments.length>1?void(i[t]=e):i[t]},initConfig:function(t){t=this._config=t||{},t.baseZIndex>-1&&(this.baseZIndex=t.baseZIndex)},_isValidLayer:function(t){return rl.isObject(t)&&rl.isFunction(t.getZIndex)&&rl.isFunction(t.setZIndex)},toString:function(){return"[object rl.gui.LayerStack]"}}}),rl.ext(rl.gui,{popupsSpacing:5,dialogZIndexMgr:new rl.gui.LayerStack({baseZIndex:1e3}),modalDialogZIndexMgr:new rl.gui.LayerStack({baseZIndex:5e3}),popupZIndexMgr:new rl.gui.LayerStack({baseZIndex:7e3}),tooltipZIndexMgr:new rl.gui.LayerStack({baseZIndex:9e3})})}(),function(){function t(){var t=rl.dom.insertHtml("afterbegin",i,document.body);return rl.gui.makeUnselectable(t),rl.$(t).on("contextmenu",rl.gui.maskLayerPool.hndMaskLayerContextMenu),t}var e=[],i=rl.IE&&rl.VER_IE<7?'<div class="rl_masklayer"><iframe src="about:blank" frameborder="0" class="inner"></iframe><div class="inner"></div></div>':'<div class="rl_masklayer"></div>';rl.gui.maskLayerPool={hndMaskLayerContextMenu:function(t){rl.gui.autoStopContextmenu(t)},hndViewportResize:function(){var t=rl.gui.maskLayerPool,e=this;t.adjustLayerSize(e)},adjustLayerSize:function(t){var e=rl.dom.viewport;t.setWidth(e.getDocumentWidth()).setHeight(e.getDocumentHeight())},pull:function(){var i=rl.gui.maskLayerPool,n=rl.dom.viewport,r=e.shift()||new rl.DomWrap(t());return r.setLeft(0).setTop(0),i.adjustLayerSize(r),n.on("resize",i.hndViewportResize,r),r},push:function(t){var i=rl.gui.maskLayerPool,n=rl.dom.viewport;e.push(t),n.un("resize",i.hndViewportResize,t)},toString:function(){return"[object rl.gui.maskLayerPool]"}}}()});