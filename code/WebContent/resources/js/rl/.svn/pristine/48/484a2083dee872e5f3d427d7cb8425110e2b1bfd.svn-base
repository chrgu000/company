/**
 * @fileOverview GUI button control.
 * @change
 	#1 by prcjack Creates file.
 */
orderjs.define("gui.button.Button",["gui.engine","css>rl:button"],function(){rl.gui.button.Button=rl.createClass({parent:rl.gui.ControlBase,construct:function(t,i,e){rl.isPrototyping(arguments[0])||(rl.isNonNullStr(t)&&(t={text:t,action:i,renderTarget:e},this.autoRenderOnReady=!0),rl.gui.button.Button.parent.call(this,t),rl.isNonNullStr(this.id)||(this.id=this.autoId()),this.CC=this[this._nameOfCC],this.dw=new rl.dom.DomWrap,rl.gui.compStore.add(this.id,this),this.autoRenderOnReady&&rl.onReady(this.render,this),rl.dom.addEventListener(window,"unload",this.dispose,this))},members:{icon:"",disabledIcon:"",action:null,autoRenderOnReady:!0,actionEventName:"click",type:"button",width:"auto",minWidth:10,maxWidth:1e4,actived:!1,iniVisible:!0,enableActivedToggle:!1,activeAction:null,inactiveAction:null,showArrow:!0,showNormalStateBorder:!0,alignRight:!1,popup:null,_eventsDelegated:!1,_interactiveMouseTypes:["out","over","down"],_nameOfCC:"popup",_btnCss:"",_interactiveStateCssPrefix:"rl_btn_",_htmlTpl:new rl.HtmlTpl('<button class="rl_btn inline {btnCss} {btnBorderCss}" id="{id}" title="{tip}" type="{type}"><TABLE cellSpacing=0 cellPadding=0 border=0><TBODY><TR><TD class="rl_btn_left"><i>&nbsp;</i></TD><TD class="rl_btn_center btn_txt"><div class="{popupArrowCss}"><div class="{iconCss} text_ctn" style="{iconBg}">{text}</div></div></TD><TD class="rl_btn_right"><i>&nbsp;</i></TD></TR></TBODY></TABLE></button>'),render:function(t){if(this._rendered)return this;if(t=this.getRenderTarget(t),this.initView(t),this.initEles(),this._eventsDelegated||this.initEvents(),this.initStates(),"auto"==this.width);else{var i=this.width;this.width=void 0,this.setWidth(i)}this.iniVisible||this.hide();var e=this.owner;return e&&e.hndItemRender&&e.hndItemRender(this),this.initCCEvents(),this._rendered=!0,this.fireEvent("render"),this},initView:function(t){var i="",e="",n="",s=(this.alignRight?"rl_alignright ":"")+this._btnCss,o=this.showNormalStateBorder?"":"rl_btn_no_border";rl.isNonNullStr(this.icon)&&(i="with_icon",""===this.text&&(i+=" icon_only"),e="background-image: url("+this.icon+");");var h=this.owner;h&&rl.gui.menu.StandardMenu&&h instanceof rl.gui.menu.StandardMenu&&(this.showArrow=!1),this.CC&&this.showArrow&&(n="popup_arrow");var r=this._htmlTpl.renderTo(t,{id:this.id,type:this.type,text:this.text,tip:this.tip,btnCss:s,iconCss:i,iconBg:e,popupArrowCss:n,btnBorderCss:o},this.renderPosition);this.dw.setTarget(r),rl.gui.makeUnselectable(r)},initEvents:function(){var t=this.dw;t.on(this.actionEventName,this.hndActionEvent,this),t.on("mouseover",this.hndMouseover,this),t.on("mouseout",this.hndMouseout,this),t.on("mouseup",this.hndMouseover,this),t.on("mousedown",this.hndMousedown,this)},initCCEvents:function(){var t=this.CC;t&&t.on&&(t.on("show",this.active,this),t.on("hide",this.inactive,this))},initStates:function(){this.disabled&&(delete this.disabled,this.disable()),this.actived&&(delete this.actived,this.active()),this.hidden&&(delete this.hidden,this.hide())},initEles:function(){this._ctrlEle=this.dw.dom},onDispose:function(){return delete this._ctrlEle,delete this.action,this.dw.dispose(),delete this.dw,this},_getIconCtn:function(){return this._ctrlEle.getElementsByTagName("div")[1]},_getTextCtn:function(){return this._ctrlEle.getElementsByTagName("div")[1]},setWidth:function(t){var i=this.dw,e=this.width;if(/auto/i.test(t)?t="auto":/%/.test(t)||(t=parseInt(t),t>this.maxWidth?t=this.maxWidth:t<this.minWidth&&(t=this.minWidth)),t==e)return this;i.setWidth(t),this.width=t;var n=i.dom.getElementsByTagName("table")[0];return"auto"==t?("auto"!=e&&rl.dw.setTarget(n).setWidth("auto"),this._fit2TextWidth()):rl.dw.setTarget(n).setWidth("100%"),this},setHeight:function(){return this},getWidth:function(){return Math.max(parseInt(this.dw.dom.scrollWidth),this.dw.getWidth())},_updateWidth:function(){"auto"==this.width&&this._fit2TextWidth()},_fit2TextWidth:function(){var t=this._ctrlEle.getElementsByTagName("div")[1];t&&(""===this.text?rl.dom.addClass(t,"icon_only"):rl.dom.removeClass(t,"icon_only"))},active:function(){if(this.disabled||this.actived)return this;this.actived=!0,this.displayStateChangedStyle();var t=this.activeAction;return rl.isFunction(t)&&t.apply(this),this},inactive:function(){if(this.disabled||!this.actived)return this;this.actived=!1,this.displayStateChangedStyle();var t=this.inactiveAction;return rl.isFunction(t)&&t.apply(this),this},setActive:function(t){t?this.active():this.inactive()},hndActionEvent:function(evt){if(!this.disabled){this.enableActivedToggle?this.setActive(!this.actived):rl.isFunction(this.action)?this.action.apply(this):rl.isNonNullStr(this.action)&&eval(this.action);var owner=this.owner;owner&&rl.isFunction(owner.hndItemActionEvent)&&owner.hndItemActionEvent(evt,this)}},hndMouseover:function(t){if(!this.disabled&&!this.actived){var i=this.owner;i&&rl.isFunction(i.hndItemMouseover)&&i.hndItemMouseover(t,this),this.applyInteractiveStyle("over")}},hndMouseout:function(){this.disabled||this.actived||this.applyInteractiveStyle("out")},hndMousedown:function(t){if(!this.disabled){var i=this.owner;i&&rl.isFunction(i.hndItemMousedown)&&i.hndItemMousedown(this,t),this.applyInteractiveStyle("down")}},_getInteractiveStateCss:function(t){if(rl.isNonNullStr(t)&&(t=t.toLowerCase(),this._interactiveMouseTypes.contains(t))){var i=this._interactiveStateCssPrefix;return this.disabled?i+="disabled":this.actived?i+="down":this.focused?i+="out"==t?"focused":t:"out"==t?i="":i+=t,i}},toString:function(){return"[object rl.gui.button.Button]"}}}),rl.Button=rl.gui.button.Button,rl.gui.ctype2Classes.add("button",rl.gui.button.Button)});