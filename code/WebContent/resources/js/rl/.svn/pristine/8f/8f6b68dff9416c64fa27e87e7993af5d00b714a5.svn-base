/*! JsViews v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 53 (Beta Candidate) */
/*
 * Interactive data-driven views using templates and data-linking.
 * Requires jQuery and jsrender.js (next-generation jQuery Templates, optimized for pure string-based rendering)
 *    See JsRender at http://github.com/BorisMoore/jsrender and http://jsviews.com/jsrender
 * Also requires jquery.observable.js
 *    See JsObservable at http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews

 * Copyright 2014, Boris Moore
 * Released under the MIT License.
 */
!function(e,t,n){"use strict";function r(e){var t=this.linkedElem;t&&i({target:t[0]},e)}function i(e,r){var i,l,a,o,s,d,f,c,u,g,v,h,_,m,b,x,k,C=e.target,v=C._jsvBnd,y=/&(\d+)\+?/g;if(v)for(;g=y.exec(v);)(g=Ft[g[1]])&&(x=g.to)&&(o=g.linkCtx,u=o.view,b=o.tag,c=t(C),_=u.hlp(bt),m=u.hlp(xt),a=p(C),i=Nt[a],r===n&&(r=ft(a)?a(C):i?c[i]():c.attr(a)),d=x[1],x=x[0],d&&(s=ft(d)?d:u.getRsc("converters",d)),s&&(r=s.call(b,r)),h=u.linkCtx,u.linkCtx=o,k={change:"change",oldValue:o._val,value:r},_&&(l=_.call(o,e,k)===!1)||b&&b.onBeforeChange&&(l=b.onBeforeChange(e,k)===!1)||r===n||(f=x[0],r!==n&&f&&(f=f._jsvOb?f._ob:f,b&&(b._.chging=!0),ut(f).setProperty(x[2]||x[1],r),m&&m.call(o,e,k),b&&(b.onAfterChange&&b.onAfterChange(e,k),delete b._.chging),o._val=r)),u.linkCtx=h)}function l(e,t,i){var l,s,d,f=this,c=f.data,u=f.elem,v=f.convert,h=u.parentNode,_=f.view,m=(_.ctx,_.linkCtx),b=_.hlp(bt);if(_.linkCtx=f,!(!h||b&&t&&b.call(f,e,t)===!1||t&&"*"!==e.data.prop&&e.data.prop!==t.path)){if(t&&(f.eventArgs=t),t||f._initVal){if(delete f._initVal,s=i.call(_.tmpl,c,_,lt),l=a(s,f,d,f.attr||p(u,!0,v!==n)),d=f.tag){if(t&&d.onUpdate&&d.onUpdate(e,t,s=s[0]?s:[s])===!1||"none"===l)return d.tagCtxs=s,d.tagCtx=s[0],l===Et&&d.onBeforeLink&&d.onBeforeLink(),S(d,d.tagCtx),g(f,c,u),void(_.linkCtx=m);if(d._.chging)return;s=":"===d.tagName.slice(-1)?lt._cnvt(d.tagName.slice(0,-1),_,s):lt._tag(d,_,_.tmpl,s,!0)}else i._ctxs&&(v=""===v?"true":v,s=v?lt._cnvt(v,_,s):lt._tag(i._ctxs,_,_.tmpl,s,!0),d=_._.tag,l=f.attr||l);o(s,f,l,d)&&t&&(b=_.hlp(xt))&&b.call(f,e,t)}d&&(d.contents=j,d.nodes=B,d.childTags=E,d.currentCtxs=N,d.update=r,d.refresh=V,S(d,d.tagCtx)),g(f,c,u),_.linkCtx=m}}function a(e,r,i,l){var a,o,s,d,f=i&&i.parentElem||r.elem;if(e!==n){if(d=t(f),l=i&&i.attr||l,ft(e)&&Tt(r.expr+": missing parens"),"visible"===l&&(l="css-display"),s=/^css-/.test(l)&&l.slice(4))a=t.style(f,s),+e===e&&(a=parseInt(a)),a=t.style(f,s);else if("link"!==l){if("value"===l)f.type===yt&&(a=d.prop(l=Ct));else if(l===wt){if(f.value!==""+e)return l;a=d.prop(Ct)}a===n&&(o=Nt[l],a=o?d[o]():d.attr(l))}r._val=a}return l}function o(e,r,i,l){var a,o,s,f,p,c,u,v,h,_,m=e!==n,b=r.data,x=l&&l.parentElem||r.elem,k=t(x),C=r.view,y=r._val,w=C.ctx,A=C.linkCtx,j=l||i===Et;if(l&&(l.parentElem=l.parentElem||r.expr||l._elCnt?x:x.parentNode,o=l._prv,s=l._nxt),!m)return void(i===Et&&l&&l.onBeforeLink&&l.onBeforeLink());if(/^css-/.test(i))"visible"===r.attr&&(e=e?d(x):"none"),(j=j||y!==e)&&t.style(x,i.slice(4),e);else if("link"!==i){if(i===Ct)c=1,e=e&&"false"!==e;else if(i===wt){if(x.value!==""+e)return void g(r,b,x);e=!0,c=1,i=Ct}else("selected"===i||"disabled"===i||"multiple"===i||"readonly"===i)&&(e=e&&"false"!==e?i:null);(a=Nt[i])?i===Et?(C.linkCtx=r,C.ctx=r.ctx,l&&l._.inline?(p=l.nodes(!0),l._elCnt&&(o&&o!==s?q(o,s,x,l._tgId,"^",!0):(u=x._dfr)&&(v=l._tgId+"^",h=u.indexOf("#"+v)+1,_=u.indexOf("/"+v),h&&_>0&&(h+=v.length,_>h&&(x._dfr=u.slice(0,h)+u.slice(_),O(u.slice(h,_))))),o=o?o.previousSibling:s?s.previousSibling:x.lastChild),t(p).remove(),l&&l.onBeforeLink&&l.onBeforeLink(),f=C.link(C.data,x,o,s,e,l&&{tag:l._tgId,lazyLink:l.tagCtx.props.lazyLink})):(m&&k.empty(),l&&l.onBeforeLink&&l.onBeforeLink(),m&&(f=C.link(b,x,o,s,e,l&&{tag:l._tgId}))),C.linkCtx=A,C.ctx=w):(j=j||y!==e)&&("text"===i&&x.children&&!x.children[0]?x.textContent!==n?x.textContent=e:x.innerText=null===e?"":e:k[a](e)):(j=j||y!==e)&&k[c?"prop":"attr"](i,e!==n||c?e:null),r._val=e}return f||j}function s(e,t){var n=this,r=n.hlp(bt),i=n.hlp(xt);if(!r||r.call(this,e,t)!==!1){if(t){var l=t.change,a=t.index,o=t.items;switch(l){case"insert":n.addViews(a,o);break;case"remove":n.removeViews(a,o.length);break;case"move":n.refresh();break;case"refresh":n.refresh()}}i&&i.call(this,e,t)}}function d(t){var n,r,i=e.getComputedStyle,l=(t.currentStyle||i.call(e,t,"")).display;return"none"!==l||(l=Ut[r=t.nodeName])||(n=it.createElement(r),it.body.appendChild(n),l=(i?i.call(e,n,""):n.currentStyle).display,Ut[r]=l,it.body.removeChild(n)),l}function f(e){var r,i,l=e.data,a=e._.bnd;!e._.useKey&&a&&((i=e._.bndArr)&&(t([i[1]]).off(_t,i[0]),e._.bndArr=n),a!==!!a&&a._.inline?l?a._.arrVws[e._.id]=e:delete a._.arrVws[e._.id]:l&&(r=function(t){t.data&&t.data.off||s.apply(e,arguments)},t([l]).on(_t,r),e._.bndArr=[r,l]))}function p(e,t,n){var r=e.nodeName.toLowerCase(),i=ot.merge[r]||"true"===e.contentEditable&&{to:Et,from:Et};return i?t?"input"===r&&e.type===wt?wt:i.to:i.from:t?n?"text":Et:""}function c(e,r,i,l,a,o,s){var d,f,p,c,u,g=e.parentElem,v=e._prv,h=e._nxt,_=e._elCnt;if(v&&v.parentNode!==g&&Tt("Missing parentNode"),s){c=e.nodes(),_&&v&&v!==h&&q(v,h,g,e._.id,"_",!0),e.removeViews(n,n,!0),f=h,_&&(v=v?v.previousSibling:h?h.previousSibling:g.lastChild),t(c).remove();for(u in e._.bnds)T(u)}else{if(r){if(p=l[r-1],!p)return!1;v=p._nxt}_?(f=v,v=f?f.previousSibling:g.lastChild):f=v.nextSibling}d=i.render(a,o,e._.useKey&&s,e,s||r,!0),e.link(a,g,v,f,d,p)}function u(e,t,r){var i,l,a;return r?(a="^`",l=t._.tag||{_:{inline:!0,bnd:r},tagCtx:{view:t},flow:!0},i=l._tgId,i||(Ft[i=Qt++]=l,l._tgId=""+i)):(a="_`",zt[i=t._.id]=t),"#"+i+a+(e===n?"":e)+"/"+i+a}function g(e,t,r){var i,l,a,o=e.tag,s=e.convertBack,d=[],f=e._bndId||""+Qt++,p=e._hdlr;if(delete e._bndId,o&&(d=o.depends||d,d=ft(d)?o.depends(o):d,a=o.linkedElem),e._depends&&""+e._depends==""+d||(e._depends&&ut._apply(!1,[t],e._depends,p,!0),i=ut._apply(!1,[t],e.fn.paths,d,p,e._ctxCb),i.elem=r,i.linkCtx=e,i._tgId=f,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+f,e._depends=d,e.view._.bnds[f]=f,Ft[f]=i,a&&(i.to=[[],s]),(a||s!==n)&&L(i,o&&o.convertBack||s),o&&(o.onAfterBind&&o.onAfterBind(i),o.flow||o._.inline||(r.setAttribute(vt,(r.getAttribute(vt)||"")+"#"+f+"^/"+f+"^"),o._tgId=""+f))),a&&a[0])for(o._.radio&&(a=a.children("input[type=radio]")),l=a.length;l--;)a[l]._jsvBnd=a[l]._jsvBnd||r._jsvBnd+"+",a[l]._jsvLnkdEl=o}function v(e,t,n,r,i,l,a){return h(this,e,t,n,r,i,l,a)}function h(e,r,l,a,o,s,d,f){if(e&&r){r=r.jquery?r:t(r),F||(F=it.body,t(F).on(mt,i).on("blur","[contenteditable]",function(e){var t=ot.noValidate;ot.noValidate=!0,i(e),ot.noValidate=t}));for(var p,c,g,v,h,_,b,x,k=u,y=a&&"replace"===a.target,w=r.length;w--;)if(b=r[w],""+e===e)h=Q(b),x=h.ctx,h.ctx=a,m(e,b,h,l),h.ctx=x;else{if(s=s||Q(b),e.markup!==n)s.link===!1&&(a=a||{},a.link=k=!1),y&&(_=b.parentNode),g=e.render(l,a,o,s,n,k),_?(d=b.previousSibling,f=b.nextSibling,t.cleanData([b],!0),_.removeChild(b),b=_):(d=f=n,t(b).empty());else if(e!==!0)break;if(b._dfr&&!f){for(v=C(b._dfr,1,Wt),p=0,c=v.length;c>p;p++)h=v[p],(h=zt[h.id])&&h.data!==n&&h.parent.removeViews(h._.key,n,!0);b._dfr=""}s.link(l,b,d,f,g,n,a)}}return r}function _(e,i,l,a,o,d,p,c){function g(e,t,r,i,l,a,s,d,f,p,c,u,g){var v,h="";return g?(b=0,e):(A=d||f||"",i=i||p,r=r||u,ct&&!r&&(i||A||a)&&(ct=n,pt=Lt.shift()),i=i||r,i&&(b=0,ct=n,ot.noValidate||(r||u?Kt[pt]||(v="'<"+pt+".../"):Kt[i]?v="'</"+i:Lt.length&&i===pt||(v="Mismatch: '</"+i),v&&Dt(v+">' in:\n"+o)),mt=_t,pt=Lt.shift(),_t=Ot[pt],p=p?"</"+p+">":"",mt&&(Nt+=xt,xt="",_t?Nt+="-":(h=p+jt+"@"+Nt+At+(c||""),Nt=Vt.shift()))),_t?(a?xt+=a:t=p||u||"",A&&(t+=A,xt&&(t+=" "+vt+'="'+xt+'"',xt=""))):t=a?t+h+l+jt+a+At+s+A:h||e,b&&a&&Dt(" No {^{ tags within elem markup ("+b+' ). Use data-link="..."'),A&&(b=A,Lt.unshift(pt),pt=A.slice(1),Lt[0]&&Lt[0]===$t[pt]&&Tt("Parent of <tr> must be <tbody>"),ct=Kt[pt],(_t=Ot[pt])&&!mt&&(Vt.unshift(Nt),Nt=""),mt=_t,Nt&&_t&&(Nt+="+")),t)}function v(e,t){var r,l,a,o,d,p,c,g=[];if(e){for("@"===e._tkns.charAt(0)&&(t=P.previousSibling,P.parentNode.removeChild(P),P=null),D=e.length;D--;){if(q=e[D],a=q.ch,r=q.path)for(T=r.length-1;l=r.charAt(T--);)"+"===l?"-"===r.charAt(T)?(T--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;"^"===a?(A=Ft[d=q.id])&&(c=t&&(!P||P.parentNode!==t),(!P||c)&&(A.parentElem=t),q.elCnt&&c&&(t._dfr=(q.open?"#":"/")+d+a+(t._dfr||"")),g.push([c?null:P,q])):(R=zt[d=q.id])&&(R.link||(R.parentElem=t||P&&P.parentNode||i,st(R,z),R._.onRender=u,R._.onArrayChange=s,f(R)),o=R.parentElem,q.open?(R._elCnt=q.elCnt,t?t._dfr="#"+d+a+(t._dfr||""):(R._prv||(o._dfr=x(o._dfr,"#"+d+a)),R._prv=P)):(!t||P&&P.parentNode===t?P&&(R._nxt||(o._dfr=x(o._dfr,"/"+d+a)),R._nxt=P):(t._dfr="/"+d+a+(t._dfr||""),R._nxt=n),k=R.linkCtx,(p=R.ctx&&R.ctx.onAfterCreate||It)&&p.call(k,R)))}for(D=g.length;D--;)St.push(g[D])}return!e||e.elCnt}function h(e){var t,n;if(e)for(D=e.length,T=0;D>T;T++)if(q=e[T],rt.id)rt.id=rt.id!==q.id&&rt.id;else if(n=A=Ft[q.id].linkCtx.tag,!A.flow){if(!W){for(t=1;n=n.parent;)t++;Y=Y||t}!W&&t!==Y||X&&A.tagName!==X||J.push(A)}}function _(){for(M=qt?i.querySelectorAll(tt):t(tt,i).get(),I=M.length,l&&l.innerHTML&&($=qt?l.querySelectorAll(tt):t(tt,l).get(),l=$.length?$[$.length-1]:l),Y=0,L=0;I>L;L++)if(P=M[L],l&&!yt)yt=P===l;else{if(a&&P===a)break;P.parentNode&&Pt(C(P,n,J&&Yt))&&!rt&&P.getAttribute(et)&&St.push([P])}if(y(l,_t),y(a,_t),rt)return void(wt&&wt.resolve());for(_t&&Nt+xt&&(P=a,Nt&&(a?v(C(Nt+"+",1),a):v(C(Nt,1),i)),v(C(xt,1),i),a&&(ht=a.getAttribute(vt),(I=ht.indexOf(Ct)+1)&&(ht=ht.slice(I+Ct.length-1)),a.setAttribute(vt,xt+ht))),I=St.length,L=0;I>L;L++)P=St[L],O=P[1],P=P[0],O?(A=Ft[O.id])&&((k=A.linkCtx)&&(A=k.tag,A.linkCtx=k),O.open?(P&&(A.parentElem=P.parentNode,A._prv=P),A._elCnt=O.elCnt,!A||A.onBeforeLink&&A.onBeforeLink()===!1||A._.bound||(A._.bound=!0,R=A.tagCtx.view,m(n,A._prv,R,e,O.id)),A._.linking=!0):(A._nxt=P,A._.linking&&(G=A.tagCtx,R=G.view,A.contents=j,A.nodes=B,A.childTags=E,A.currentCtxs=N,A.update=r,A.refresh=V,delete A._.linking,A._.bound||(A._.bound=!0,m(n,A._prv,R,e,O.id)),S(A,G)))):(R=Q(P),m(P.getAttribute(et),P,R,e,n,p));wt&&wt.resolve()}var b,k,A,L,I,T,D,M,P,R,q,O,$,K,U,F,H,J,W,X,G,Y,rt,lt,at,dt,ft,pt,ct,ut,gt,ht,_t,mt,bt,xt,Ct,yt,wt,Bt=this,Et=Bt._.id+"_",Nt="",St=[],Lt=[],Vt=[],It=Bt.hlp(kt),Pt=v;if(d&&(wt=d.lazyLink&&t.Deferred(),d.tmpl?U="/"+d._.id+"_":(rt=d.get,d.tag&&(Et=d.tag+"^",d=!0)),d=d===!0),rt&&(Pt=h,J=rt.tags,W=rt.deep,X=rt.name),i=i?""+i===i?t(i)[0]:i.jquery?i[0]:i:Bt.parentElem||it.body,pt=i.tagName.toLowerCase(),_t=!!Ot[pt],l=l&&w(l,_t),a=a&&w(a,_t)||null,o!==n){if(gt=it.createElement("div"),ut=gt,Ct=xt="",bt="http://www.w3.org/2000/svg"===i.namespaceURI?"svg_ns":(ft=Mt.exec(o))&&ft[1]||"",Z&&ft&&ft[2]&&Tt("Unsupported: "+ft[2]),_t){for(H=a;H&&!(F=C(H));)H=H.nextSibling;(ht=F?F._tkns:i._dfr)&&(K=U||"",(d||!U)&&(K+="#"+Et),T=ht.indexOf(K),T+1&&(T+=K.length,Ct=xt=ht.slice(0,T),ht=ht.slice(T),F?H.setAttribute(vt,ht):i._dfr=ht))}if(ct=n,o=(""+o).replace(Jt,g),!ot.noValidate&&Lt.length&&Dt("Mismatched '<"+pt+"...>' in:\n"+o),c)return;for(Rt.appendChild(gt),bt=nt[bt]||nt.div,lt=bt[0],ut.innerHTML=bt[1]+o+bt[2];lt--;)ut=ut.lastChild;for(Rt.removeChild(gt),at=it.createDocumentFragment();dt=ut.firstChild;)at.appendChild(dt);i.insertBefore(at,a)}return wt?setTimeout(_,0):_(),wt&&wt.promise()}function m(e,t,r,i,l,a){var o,s,d,f,c,u,g,v,h,_,m;if(i=r.data===n?i||{}:r.data,l)_=Ft[l],_=_.linkCtx?_.linkCtx.tag:_,h=_.linkCtx||{data:i,elem:_._elCnt?_.parentElem:t,view:r,ctx:r.ctx,attr:Et,fn:_._.bnd,tag:_,_bndId:l},b(h,h.fn);else if(e&&t)for(o=r.tmpl,e=A(e,p(t)),H.lastIndex=0;s=H.exec(e);)m=H.lastIndex,d=l?Et:s[1],g=s[3],c=s[10],f=n,h={data:i,elem:_&&_._elCnt?_.parentElem:t,view:r,ctx:a||r.ctx,attr:d,_initVal:!s[2]},s[6]&&(!d&&(f=/:([\w$]*)$/.exec(c))&&(f=f[1],f!==n&&(u=-f.length-1,g=g.slice(0,u-1)+X,c=c.slice(0,u))),null===f&&(f=n),h.convert=s[5]||""),h.expr=d+g,v=o.links[g],v||(o.links[g]=v=at.tmplFn(J+g+G,o,!0,f),at.parse(c,v.paths=[],o)),h.fn=v,d||f===n||(h.convertBack=f),b(h,v),H.lastIndex=m}function b(e,t){function n(n,r){l.call(e,n,r,t)}n.noArray=!0,e._ctxCb=P(e.view),e._hdlr=n,n(!0)}function x(e,t){var n;return e?(n=e.indexOf(t),n+1?e.slice(0,n)+e.slice(n+t.length):e):""}function k(e){return e&&(""+e===e?e:"SCRIPT"===e.tagName?e.type.slice(3):1===e.nodeType&&e.getAttribute(vt)||"")}function C(e,t,n){function r(e,t,n,r,l,o){a.push({elCnt:i,id:r,ch:l,open:t,close:n,path:o,token:e})}var i,l,a=[];return(l=t?e:k(e))?(a.elCnt=!e.type,i="@"===l.charAt(0)||!e.type,a._tkns=l,l.replace(n||Zt,r),a):void 0}function y(e,t){e&&("jsv"===e.type?e.parentNode.removeChild(e):t&&""===e.getAttribute(et)&&e.removeAttribute(et))}function w(e,t){for(var n=e;t&&n&&1!==n.nodeType;)n=n.previousSibling;return n&&(1!==n.nodeType?(n=it.createElement("SCRIPT"),n.type="jsv",e.parentNode.insertBefore(n,e)):k(n)||n.getAttribute(et)||n.setAttribute(et,"")),n}function A(e,n){return e=t.trim(e).replace(Pt,"\\$&"),e.slice(-1)!==X?e=W+":"+e+(n?":":"")+X:e}function j(e,r){e!==!!e&&(r=e,e=n);var i,l=t(this.nodes());return l[0]&&(i=r?l.filter(r):l,l=e&&r?i.add(l.find(r)):i),l}function B(e,t,n){var r,i=this,l=i._elCnt,a=!t&&l,o=[];for(t=t||i._prv,n=n||i._nxt,r=a?t===i._nxt?i.parentElem.lastSibling:t:i._.inline===!1?t||i.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!n||r!==n);)(e||l||"SCRIPT"!==r.tagName)&&o.push(r),r=r.nextSibling;return o}function E(e,t){e!==!!e&&(t=e,e=n);var r=this,i=r.link?r:r.tagCtx.view,l=r._prv,a=r._elCnt,o=[];return l&&i.link(n,r.parentElem,a?l.previousSibling:l,r._nxt,n,{get:{tags:o,deep:e,name:t,id:a&&r._tgId}}),o}function N(){var e=this.tagCtx.view;return this._.bnd.call(e.tmpl,e.data,e,lt)}function S(e,t){var r,i,l,a,o,s,d,f,p=t.view,c=e.linkCtx=e.linkCtx||{tag:e,data:p.data,view:p,ctx:p.ctx};if(e.onAfterLink&&e.onAfterLink(t,c),r=e.targetTag?e.targetTag.linkedElem:e.linkedElem,r&&(i=r[0])&&((l=e._.radio)&&(r=r.children("input[type=radio]")),l||!e._.chging)){if(a=at.cvt(e,e.convert)[0],l||i!==c.elem){for(d=r.length;d--;){if(i=r[d],f=i._jsvLnkdEl,e._.inline&&(!f||f!==e&&f.targetTag!==e))for(i._jsvLnkdEl=e,o=c.elem?c.elem._jsvBnd:e._prv._jsvBnd,i._jsvBnd=o+"+",o=o.slice(1).split("&"),s=o.length;s--;)L(Ft[o[s]],e.convertBack);l&&(i[Ct]=a===i.value)}c._val=a}l||i.value===n||a===n||(i.type===yt?i[Ct]=a&&"false"!==a:r.val(a))}}function L(e,t){var n,r,i,l,a,o=e.linkCtx,s=o.data,d=o.fn.paths;if(e){for((n=d._jsvto)&&(d=n),r=d.length;r&&""+(l=d[--r])!==l;);!l||o.tag&&!o.tag.tagCtx.args.length?e.to=[[],t]:(l=l.split("^").join("."),e.to="."===l.charAt(0)?[[a=d[r-1],l.slice(1)],t]:[o._ctxCb(i=r?d[0].split("^").join("."):l)||[s,i],t],n&&a&&(e.to[0][0]=o._ctxCb(a,s)))}}function V(e){var t,r,i=this,l=i.linkCtx,a=i.tagCtx.view;return i.disposed&&Tt("Removed tag"),e===n&&(e=lt._tag(i,a,a.tmpl,i.currentCtxs?i.currentCtxs():i.tagCtxs,!0)),e+""===e&&(r=i._.inline?Et:l.attr||p(i.parentElem,!0),t=o(e,l,r,i)),S(i,i.tagCtx),t||i}function I(e){for(var t,n,r,i=[],l=e.length,a=l;a--;)i.push(e[a]);for(a=l;a--;)if(n=i[a],n.parentNode){if(r=n._jsvBnd)for(r=r.slice(1).split("&"),n._jsvBnd="",t=r.length;t--;)T(r[t],n._jsvLnkdEl,n);O(k(n)+(n._dfr||""))}}function T(e,n,r){var i,l,a,o,s,d,f,p,c=Ft[e];if(n)r===n.linkedElem[0]&&(delete r._jsvLnkdEl,delete n.linkedElem);else if(c){for(i in c.bnd)o=c.bnd[i],s=".obs"+c.cbId,t.isArray(o)?t([o]).off(_t+s).off(ht+s):t(o).off(ht+s),delete c.bnd[i];if(l=c.linkCtx){if(a=l.tag){if(d=a.tagCtxs)for(f=d.length;f--;)(p=d[f].map)&&p.unmap();a.onDispose&&a.onDispose(),a._elCnt||(a._prv&&a._prv.parentNode.removeChild(a._prv),a._nxt&&a._nxt.parentNode.removeChild(a._nxt)),a.disposed=!0}delete l.view._.bnds[e]}delete Ft[e],delete at._cbBnds[c.cbId]}}function D(e,r){return e===n?(F&&(t(F).off(mt,i),F=n),e=!0,dt.removeViews(),I(it.body.getElementsByTagName("*"))):r&&(r=r.jquery?r:t(r),e===!0&&r.each(function(){for(var e;(e=Q(this,!0))&&e.parent;)e.parent.removeViews(e._.key,n,!0);I(this.getElementsByTagName("*"))})),r}function M(e,t){return D(this,e,t)}function P(e){return e=e||t.view(),function(t,n){var r,i,l=[n];if(e&&t){if(t._jsvOb)return t._jsvOb.call(e.tmpl,n,e,lt);if("~"===t.charAt(0))return"~tag"===t.slice(0,4)&&(i=e.ctx,"."===t.charAt(4)&&(r=t.slice(5).split("."),i=i.tag),r)?i?[i,r.join("."),n]:[]:(t=t.slice(1).split("."),(n=e.hlp(t.shift()))&&(t.length&&l.unshift(t.join(".")),l.unshift(n)),n?l:[]);if("#"===t.charAt(0))return"#data"===t?[]:[e,t.replace(Ht,""),n]}}}function R(e){return e.type===yt?e[Ct]:e.value}function q(e,t,n,r,i,l){var a,o,s,d,f,p,c,u=0,g=e===t;if(e){for(s=C(e)||[],a=0,o=s.length;o>a;a++){if(d=s[a],p=d.id,p===r&&d.ch===i){if(!l)break;o=0}g||(f="_"===d.ch?zt[p]:Ft[p].linkCtx.tag,d.open?f._prv=t:d.close&&(f._nxt=t)),u+=p.length+2}u&&e.setAttribute(vt,e.getAttribute(vt).slice(u)),c=t?t.getAttribute(vt):n._dfr,(o=c.indexOf("/"+r+i)+1)&&(c=s._tkns.slice(0,u)+c.slice(o+(l?-1:r.length+1))),c&&(t?t.setAttribute(vt,c):n._dfr=c)}else n._dfr=x(n._dfr,"#"+r+i),l||t||(n._dfr=x(n._dfr,"/"+r+i))}function O(e){var t,r,i,l;if(l=C(e,1,Xt))for(t=0,r=l.length;r>t;t++)i=l[t],"_"===i.ch?(i=zt[i.id])&&i.data!==n&&i.parent.removeViews(i._.key,n,!0):T(i.id)}function $(e,n,r,i){switch(i.change){case"set":for(var l=n.length;l--&&n[l].key!==i.path;);-1===l?i.path&&t.observable(n).insert({key:i.path,prop:i.value}):null===i.value?(delete e[i.path],t.observable(n).remove(l)):t.observable(n[l]).setProperty("prop",i.value)}}function K(e,n,r,i){var l;switch(i.change){case"set":"prop"===i.path?t.observable(e).setProperty(r.target.key,i.value):(t.observable(e).setProperty(i.oldValue,null),delete e[i.oldValue],t.observable(e).setProperty(i.value,r.target.prop));break;case"remove":l=i.items[0],t.observable(e).setProperty(l.key,null),delete e[l.key];break;case"insert":l=i.items[0],l.key&&t.observable(e).setProperty(l.key,l.prop)}}function U(e,t,n){return n.indexOf(".")<0&&t[e]}var z,F,Q,H,J,W,X,G,Y,Z,et,tt,nt,rt="JsViews requires ",it=e.document,lt=t.views,at=lt.sub,ot=lt.settings,st=at.extend,dt=at.View(n,"top"),ft=at.isFn,pt=lt.templates,ct=lt.converters,ut=t.observable,gt=ut.observe,vt="data-jsv",ht=at.propChng=at.propChng||"propertyChange",_t=at.arrChng=at.arrChng||"arrayChange",mt=(at._cbBnds=at._cbBnds||{},"change.jsv"),bt="onBeforeChange",xt="onAfterChange",kt="onAfterCreate",Ct="checked",yt="checkbox",wt="radio",At='"></script>',jt='<script type="jsv',Bt="script,["+vt+"]",Et="html",Nt={value:"val",input:"val",html:Et,text:"text"},St={from:"value",to:"value"},Lt=0,Vt=t.cleanData,It=ot.delimiters,Tt=at.err,Dt=at.syntaxErr,Mt=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,Pt=/['"\\]/g,Rt=it.createDocumentFragment(),qt=it.querySelector,Ot={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},$t={tr:"table"},Kt={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},Ut={},zt={0:dt},Ft={},Qt=1,Ht=/^#(view\.?)?/,Jt=/(^|(\/>)|<\/(\w+)>|)(\s*)([#\/]\d+[_^])`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>))/g,Wt=/(#)()(\d+)(_)/g,Xt=/(#)()(\d+)([_^])/g,Gt=/(?:(#)|(\/))(\d+)(_)/g,Yt=/(#)()(\d+)(\^)/g,Zt=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g;if(!t)throw rt+"jQuery";if(!t.views)throw rt+"JsRender";if(!t.observable)throw rt+"jquery.observable";t.link||(at.onStoreItem=function(e,n,r){r&&e===pt&&(r.link=v,r.unlink=M,n&&(t.link[n]=function(){return v.apply(r,arguments)},t.unlink[n]=function(){return M.apply(r,arguments)}))},(ot.delimiters=function(){var e=It.apply(lt,arguments);return J=e[0],W=e[1],X=e[2],G=e[3],Y=e[4],H=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+Y+")?(\\"+W+at.rTag+"\\"+X+")","g"),this})(),at.viewInfos=C,z={addViews:function(e,t,n){var r,i,l=this,a=t.length,o=l.views;if(!l._.useKey&&a&&(n=l.tmpl)&&(i=o.length+a,c(l,e,n,o,t,l.ctx)!==!1))for(r=e+a;i>r;r++)ut(o[r]).setProperty("index",r);return l},removeViews:function(e,r,i){function l(e){var r,l,a,o,s,d,p=c[e];if(p&&p.link){if(r=p._.id,i||(d=p.nodes()),p.removeViews(n,n,!0),p.data=n,o=p._prv,s=p._nxt,a=p.parentElem,i||(p._elCnt&&q(o,s,a,r,"_"),t(d).remove()),!p._elCnt)try{o.parentNode.removeChild(o),s.parentNode.removeChild(s)}catch(u){}f(p);for(l in p._.bnds)T(l);delete zt[r]}}var a,o,s,d=this,p=!d._.useKey,c=d.views;if(p&&(s=c.length),e===n)if(p){for(a=s;a--;)l(a);d.views=[]}else{for(o in c)l(o);d.views={}}else if(r===n&&(p?r=1:(l(e),delete c[e])),p&&r){for(a=e+r;a-->e;)l(a);if(c.splice(e,r),s=c.length)for(;s>e;)ut(c[e]).setProperty("index",e++)}return this},refresh:function(e){var t=this,n=t.parent;return n&&(c(t,t.index,t.tmpl,n.views,t.data,e,!0),f(t)),t},nodes:B,contents:j,childTags:E,link:_},ct.merge=function(e){var t,n=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",n=n.replace(new RegExp(t),"$2"),e=n+(e?(n&&" ")+r:"")),e},lt.tags("on",{attr:"none",onAfterLink:function(e,r){var i=this,l=t(r.elem),a=e.args,o=e.props.data,s=a.pop(),d=a[1]||null,f=e.props.context;o=o!==n?o:null,s&&s.call&&l.on(a[0]||"click",d,o,function(e){s.call(f||i.leaf,e,{change:e.type,view:r.view,linkCtx:r})})},onAfterBind:function(e){this.leaf=e.leaf},flow:!0}),st(lt.tags["for"],{onArrayChange:function(e,t){var n,r=this,i=t.change;if(r.tagCtxs[1]&&("insert"===i&&e.target.length===t.items.length||"remove"===i&&!e.target.length||"refresh"===i&&!t.oldItems.length!=!e.target.length))r.refresh();else for(n in r._.arrVws)n=r._.arrVws[n],n.data===e.target&&n._.onArrayChange.apply(n,arguments);e.done=!0},onAfterLink:function(){var e,n,r,i,l,a=this,o=a._ars||{},s=a.tagCtxs,d=s.length,f=a.selected||0;for(e=0;f>=e;e++)n=s[e],l=n.map?n.map.tgt:n.args.length?n.args[0]:n.view.data,(i=o[e])&&l!==i[0]&&(gt(i[0],i[1],!0),delete o[e]),!o[e]&&t.isArray(l)&&(gt(l,r=function(e,t){a.onArrayChange(e,t)}),o[e]=[l,r]);for(e=f+1;d>e;e++)(i=o[e])&&(gt(i[0],i[1],!0),delete o[e]);a._ars=o},onDispose:function(){var e,t=this;for(e in t._ars)gt(t._ars[e][0],t._ars[e][1],!0)}}),lt.tags({props:t.extend({},lt.tags["for"],at.DataMap(lt.tags.props.getTgt,$,K,n,U))}),st(t,{view:lt.view=Q=function(e,r,i){r!==!!r&&(i=r,r=n);var l,a,o,s,d,f,p,c,u=0,g=it.body;if(e&&e!==g&&dt._.useKey>1&&(e=""+e===e?t(e)[0]:e.jquery?e[0]:e))if(r){for(c=qt?e.querySelectorAll(Bt):t(Bt,e).get(),f=c.length,o=0;f>o;o++)for(p=c[o],a=C(p,n,Wt),s=0,d=a.length;d>s;s++)if(l=a[s],(l=zt[l.id])&&(l=l&&i?l.get(!0,i):l))return l}else for(;e;){if(a=C(e,n,Gt))for(f=a.length;f--;)if(l=a[f],l.open){if(1>u)return l=zt[l.id],l&&i?l.get(i):l||dt;u--}else u++;e=e.previousSibling||e.parentNode}return r?n:dt},link:lt.link=h,unlink:lt.unlink=D,cleanData:function(e){e.length&&Lt&&I(e),Vt.apply(t,arguments)}}),lt.utility={validate:function(e){try{dt.link(n,it.createElement("div"),n,n,e,n,n,1)}catch(t){return t.message}}},st(t.fn,{link:function(e,t,n,r,i,l,a){return h(e,this,t,n,r,i,l,a)},unlink:function(e){return D(e,this)},view:function(e){return Q(this[0],e)}}),t.each([Et,"replaceWith","empty","remove"],function(e,n){var r,i=t.fn[n];t.fn[n]=function(){Lt=1;try{r=i.apply(this,arguments)}finally{Lt=0}return r}}),st(dt,{tmpl:{links:{},tags:{}}}),st(dt,z),dt._.onRender=u,ot({wrapMap:nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],svg_ns:[1,"<svg>","</svg>"],div:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},linkAttr:et="data-link",merge:{input:{from:R,to:"value"},textarea:St,select:St,optgroup:{to:"label"}},jsrDbgMode:ot.debugMode,debugMode:function(t){ot.jsrDbgMode(t),t?e._jsv={views:zt,bindings:Ft}:delete e._jsv},jsv:function(){ot.debugMode(ot._dbgMode),et=ot.linkAttr,tt=Bt+",["+et+"]",Z=ot.noDomLevel0,nt.optgroup=nt.option,nt.tbody=nt.tfoot=nt.colgroup=nt.caption=nt.thead,nt.th=nt.td}}))}(this,this.jQuery);