orderjs.define("lib.data.XJSON",["lib.data.engine"],function(){!function(){var depth=0,nested={};rl.data.XJSON=rl.createClass({construct:function(t){rl.isPrototyping(arguments[0])||t&&this.setRoot(t)},members:{defaultXmlIdField:"id",defaultJsonIdField:"id",nameOfXmlAttributes:"@attributes",nameOfXmlText:"@text",MAX_DEPTH_EACH:25,fromXml:function(t,e,r){return this._root=rl.data.XJSON.fromXml(t,e,r),this},xmlize:function(t){return rl.data.XJSON.xmlize(this._root,t)},decode:function(jsonStr){return this._root=eval("("+jsonStr+")"),this},encode:function(){return rl.data.encode(this._root)},setRoot:function(t,e,r){return rl.isElement(t)?this.fromXml(t,e,r):rl.isNonNullStr(t)?this.decode(t):this._root=t,this},getRoot:function(){return this._root},each:function(t,e,r){if(r=r||this._root,e=e||this,rl.isObject(r)&&rl.isFunction(t)){var n,i,l,o,s,a=this.nameOfXmlAttributes,u=this.nameOfXmlText;if(rl.isArray(r))for(i=0,s=r.length;s>i;i++)this.each(t,e,r[i]);else if(rl.isObject(r)){if(arguments[3]!==nested&&(depth=0),depth++,depth>this.MAX_DEPTH_EACH)throw new Error("Exceed MAX_DEPTH_EACH");try{for(n in r)if(n!=a){if(n==u)return;if(l=r[n],rl.isArray(l))for(i=0,s=l.length;s>i;i++)o=l[i],t.call(e,o,n,r,i),rl.isObject(o)&&this.each(t,e,o,nested);else t.call(e,l,n,r),rl.isObject(l)&&this.each(t,e,l,nested)}}catch(f){if(f!=rl.BREAK_EACH)throw f}finally{depth=0}}}},getByXmlId:function(t,e,r){e=rl.isNonNullStr(e)?e:this.defaultXmlIdField;var n=null,i=this.nameOfXmlAttributes,l=function(r){var l;if(rl.isObject(r)&&(l=r[i],l&&l[e]===t))throw n=r,rl.BREAK_EACH};return this.each(l,null,r),n},getByJsonId:function(t,e,r){e=rl.isNonNullStr(e)?e:this.defaultJsonIdField;var n=null,i=function(r,i,l){if(i===e&&r===t)throw n=l,rl.BREAK_EACH};return this.each(i,null,r),n},find:function(t,e,r){var n=null,i=function(r,i,l){if(t.call(e,r,i,l))throw n=r,rl.BREAK_EACH};return this.each(i,e,r),n},filter:function(t,e,r){var n=[],i=function(r,i,l){t.call(e,r,i,l)&&n.push(r)};return this.each(i,e,r),n},filterByTag:function(t,e){var r=[],n=function(e,n){n===t&&r.push(e)};return this.each(n,null,e),r},toString:function(){return this.encode()}}})}(),function(){rl.ext(rl.data.XJSON,{_caseConvertsStore:{},regCaseConverts:function(t,e){rl.isNonNullStr(t)&&(rl.data.XJSON._caseConvertsStore[t]=e)},getCaseConverts:function(t){return rl.isNonNullStr(t)?rl.data.XJSON._caseConvertsStore[t]:void 0},getInlineXmlRoot:function(t){if(t=rl.getDom(t),!t)return null;var e;return e=t.XMLDocument?t.XMLDocument.documentElement:Array.find(rl.isElement,t.childNodes)},fromXml:function(t,e,r){var n,i,l,o,s,a,u,f,c=null;if(!t||1!=t.nodeType)return c;if(e||(a=t.attributes,a&&(rl.GECKO&&t.removeAttribute("_moz-userdefined"),a.length>0&&(l={},f=!rl.IE&&rl.isObject(r)?function(t){name=r[t.name]||t.name,l[name]=t.value}:function(t){l[t.name]=t.value},Array.each(f,a),c={"@attributes":l}))),!t.hasChildNodes())return c;if(1==t.childNodes.length&&(n=t.firstChild,n&&3==n.nodeType))return i=n.nodeValue,c?c["@text"]=i:c=i,c;for(c||(c={}),n=t.firstChild;n;)1==n.nodeType&&(u=n.tagName.toLowerCase(),o=c[u],s=rl.data.XJSON.fromXml(n,e,r),o?(rl.isArray(o)||(c[u]=[o]),c[u].push(s)):c[u]=s),n=n.nextSibling;return c},xmlize:function(){}})}(),rl.xjson=new rl.data.XJSON,rl.toXjson=function(t,e,r){return rl.IE||(rl.isNonNullStr(r)&&(r=rl.data.XJSON.getCaseConverts(r)),r=r),rl.xjson.setRoot(t,e,r)}});