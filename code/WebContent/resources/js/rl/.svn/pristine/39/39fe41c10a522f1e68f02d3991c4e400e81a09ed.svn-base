/**
 * @fileOverview KpiViewFieldList
 * @change
    #1A by prcjack @2012/7/17 Creates file.
	#2M by prcjack @2012/8/17 Modify getRowsHtml method: set the empty field output value to "&nbsp;".
	#3M by prcjack @2013/1/10 Modify add "div" to wrap table because ie table element cant use innerHTML feature.
	#4M by prcjack @2013/8/18 Modify css scope to "rl_databox_field_list"
 */
orderjs.define("app.dataBox.KpiViewFieldList",["app.dataBox.engine","css>rl:databox"],function(){rl.dataBox.KpiViewFieldList=rl.createClass({parent:rl.dataBox.KpiViewHtml,construct:function(t){rl.isPrototyping(arguments[0])||rl.dataBox.KpiViewFieldList.parent.call(this,t)},members:{columnNum:1,fieldList:null,_htmlTpl:new rl.HtmlTpl('<div id="{id}">{tableHtml}</div>'),_tableTpl:new rl.HtmlTpl('<table class="rl_databox_field_list" style="height:100%;" border="0" cellspacing="0" cellpadding="0">{rowsHtml}</table>'),_fieldTpl:new rl.HtmlTpl('<th class="label">{label}</th><td {idAttr} {colspanAttr} class="field_ctn">{value}</td>'),createInnerComp:function(t){var e=rl.dataBox[t.viewType];if(rl.isFunction(e)){var i=new e(rl.fill({renderTarget:this._getCellId(t.name),autoRenderOnReady:!1},t.viewOptions));return rl.dir(t.viewOptions,"viewOptions"),this.innerComps||(this.innerComps=[]),this.innerCompsData||(this.innerCompsDataList=[]),this.innerComps.push(i),this.innerCompsDataList.push(t.value),i}return rl.debug(this+"-> createInnerView(): Invalid viewType = "+t.viewType,"err"),""},createInnerView:function(){Array.each(function(t){rl.isNonNullStr(t.viewType)&&this.createInnerComp(t)},this.fieldList,this)},disposeInnerView:function(){Array.each(function(t){t.dispose()},this.innerComps,this),this.innerComps=[]},getRowsHtml:function(){var t,e,i,n,l,r,s="",a="",o=this.fieldList,d=o.length,p=parseInt(this.columnNum);if(!(d>0))return"";for(p>0||(rl.debug(this+"-> getRowsHtml(): invalid columnNum = "+p,"warn"),p=1),l=Math.ceil(d/p),e=0,n=0;l>n;n++){for(s+="<tr>",i=0;p>i&&d>e;e++,i++)t=o[e],rl.isDefined(t.name)||(t.name=e),t.colspan>1&&(a='colspan ="'+t.colspan+'"',i+=t.colspan),r=rl.fill({colspanAttr:a},t),rl.isNonNullStr(t.viewType)?(cellId=this._getCellId(t.name),r.idAttr='id = "'+cellId+'"',r.value=""):rl.isEmpty(r.value)&&(r.value="&nbsp;"),s+=this._fieldTpl.assign(r);s+="</tr>"}return s},getRenderHtml:function(){return this._htmlTpl.assign({id:this.id,tableHtml:this.getTableHtml()})},getTableHtml:function(){return this._tableTpl.assign({rowsHtml:this.getRowsHtml()})},loadData:function(t){if(!rl.isObject(t)||!rl.isObject(t.data)){var e=this+"-> loadData(): Invalid data = "+t;throw{description:e}}this.fieldList=t.data,this._rendered?(this.disposeInnerView(),this.dw.setInnerHTML(this.getTableHtml()),this.createInnerView(),this.renderInnerView()):(this.render(),this.createInnerView(),this.renderInnerView())},renderInnerView:function(){var t=this.innerCompsDataList;Array.each(function(e,i){e.loadData(t[i])},this.innerComps,this)},_getCellId:function(t){return this.id+"_"+t},toString:function(){return"[object rl.dataBox.KpiViewFieldList]"}}})});