orderjs.define("gui.form.ActionInput",["gui.engine","gui.form.Input","css>rl:inputs","gui.button.IconButton"],function(){rl.gui.form.ActionInput=rl.createClass({parent:rl.gui.form.Input,construct:function(t){rl.isPrototyping(arguments[0])||rl.gui.form.ActionInput.parent.call(this,t)},members:{action:null,actionCtrlIcon:rl.gui.mapImg("inputs/go.gif"),actionCtrlDisabledIcon:rl.gui.mapImg("inputs/go_disabled.gif"),autoDoActionOnChange:!1,editable:!0,disabled:!1,doActionOnPressEnter:!0,_extraCtrlsWidth:30,_interactiveStateCssPrefix:"rl_ctm_input_",_interactiveMouseTypes:["out","over"],_htmlTpl:new rl.HtmlTpl('<span id="{id}" class="rl_comp rl_input rl_ctm_input {css}" title="{tip}"><label for="{ctrlId}" class="{labelCss}">{label}</label><span class="wrapper" id="{wrapperId}"><input id="{ctrlId}" value="{value}" name="{name}" class="{ctrlCss}" {disabledState} {readonlyState} /><span id="{actionCtrlId}"></span></span></span>'),initialize:function(){this.dw=new rl.dom.DomWrap,rl.isNonNullStr(this.id)||(this.id=this.autoId());var t=this.id;this.ctrlId=t+"_ctrl",this.wrapperId=t+"_wrapper",this.clearerId=t+"_clearer",this.actionCtrlId=t+"_actionCtrl",rl.gui.compStore.add(this.id,this),this.autoRenderOnReady&&rl.onReady(Function.bind(this.render,this))},initView:function(){this.initCtrl(),rl.VER_IE&&rl.VER_IE<8&&rl.$(this.wrapperId).addClass("wrapper_inline_hack"),this.initEvents(),this.initExtraCtrls(),this.initSize(),this.updateValueListener()},initEvents:function(){var t,i,e=this.dw;rl.IE?(t="focusin",i="focusout"):(t="focus",i="blur"),e.on(t,this.hndFocus,this,!0),e.on(i,this.hndBlur,this,!0),e.on("mouseout",this.hndMouseout,this),e.on("mousedown",this.hndMousedown,this),e.on("click",this.hndClick,this),this.doActionOnPressEnter&&this.on("enter",this.hndPressEnter,this),rl.gui.form.ActionInput.parent.prototype.initEvents.apply(this,arguments)},initCtrl:function(){var t=rl.getDom(this.ctrlId);this._ctrlEle=t,rl.$(t).on("change",this.hndCtrlEleChange,this),this.initTextMaskStyle(),this.initDectectBehavior()},initExtraCtrls:function(){this.initActionCtrl(),this.autoShowClearer&&this.initClearer()},initActionCtrl:function(){this.actionCtrl instanceof rl.gui.ControlBase||(this.actionCtrl=this.createActionCtrl()),this.actionCtrl.action=Function.bind(this.doAction,this)},createActionCtrl:function(){return new rl.gui.button.IconButton({_sizeCss:"actionctrl",renderTarget:this.actionCtrlId,icon:this.actionCtrlIcon,disabledIcon:this.actionCtrlDisabledIcon})},initClearer:function(){var t=rl.$(this.clearerId);t.on("mouseover",this.hndClearerMouseover,this),t.on("mouseout",this.hndClearerMouseout,this),t.on("mousedown",this.hndClearerMousedown,this),this.on("change",this.checkClearerDisplay,this),this.iniShowClearer&&this.checkClearerDisplay()},initSize:function(){var t=this.width;delete this.width,this.width=void 0,this.setWidth(t)},render:function(t){if(this._rendered)return this;t=this.getRenderTarget(t);var i,e=this.disabled?" disabled='disabled' ":"",s=this.editable?"":" readonly='readonly' ";return i=this._htmlTpl.renderTo(t,{css:this.css+(this.alignRight?" rl_alignright":""),labelCss:this.labelCss,ctrlCss:this.ctrlCss,id:this.id,ctrlId:this.ctrlId,wrapperId:this.wrapperId,clearerId:this.clearerId,actionCtrlId:this.actionCtrlId,label:this.label,tip:this.tip,name:this.name,value:this.value,disabledState:e,readonlyState:s},this.renderPosition),this.dw.setTarget(i),i=null,this.initView(),this._rendered=!0,this.fireEvent("render"),this},disable:function(){return this.disabled?this:(this.disabled=!0,this._ctrlEle&&(this._ctrlEle.disabled=!0),this.displayStateChangedStyle(),rl.isNonNullStr(this.disabledIcon)&&this._updateIconView(this.disabledIcon),this.actionCtrl.disable(),this)},enable:function(){return this.disabled?(this.disabled=!1,this._ctrlEle&&(this._ctrlEle.disabled=!1),this.displayStateChangedStyle(),rl.isNonNullStr(this.disabledIcon)&&this._updateIconView(this.getIcon()),this.actionCtrl.enable(),this):this},setWidth:function(t){var i=this.width;if(t===i)return this;var e=this.dw.dom;if(rl.isElement(e)){var s=t;if(rl.isNumber(s)||(/%/.test(s)?s=rl.$(e.parentNode).getWidth():/auto/.test(s)||(s=parseInt(s))),rl.isNumber(s)){var r=s-this._extraCtrlsWidth;rl.$(this.ctrlId).setWidth(r)}}return this.width=t,this.fireEvent("widthchange",t,i),this},clear:function(){return this.setValue(""),this},showClearer:function(){rl.$(this.clearerId).setStyle("visibility: inherit;")},hideClearer:function(){rl.$(this.clearerId).setStyle("visibility: hidden;")},checkClearerDisplay:function(){var t=String(this.value);0==t.length?this.hideClearer():this.showClearer()},hndFocus:function(){this.disabled||(this.focused=!0,this.applyInteractiveStyle("out"))},hndBlur:function(){this.disabled||(this.focused=!1,this.applyInteractiveStyle("out"))},hndMouseover:function(){this.disabled||this.applyInteractiveStyle("over")},hndMouseout:function(){this.disabled||this.applyInteractiveStyle("out")},hndMousedown:function(t){var i=rl.ew.init(t),e=i.getTarget();e.id==this.wrapperId&&rl.getDom(this.ctrlId).focus()},hndPressEnter:function(){this.doAction()},hndClick:function(){},hndClearerMouseover:function(){rl.$(this.clearerId).addClass("clearer_bg_over")},hndClearerMouseout:function(){rl.$(this.clearerId).removeClass("clearer_bg_over")},hndClearerMousedown:function(){this.clear()},_getInteractiveStateCss:function(t){if(rl.isNonNullStr(t)&&(t=t.toLowerCase(),this._interactiveMouseTypes.contains(t))){var i=this._interactiveStateCssPrefix;return this.disabled?i+="disabled":this.focused?i+="focused":"out"==t?i="":i+=t,i}},toString:function(){return"[object rl.gui.form.ActionInput]"}}}),rl.gui.ctype2Classes.add("ActionInput",rl.gui.form.ActionInput)});