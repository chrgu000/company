/**
 * @fileOverview DomWrap & EventWrap.
 * @change
    #1 by prcjack Creates file.
	#2 by prcjack @2013/8/14 Add getIndex method.
	#3 by prcjack @2014/05/29 Merged EventWrap.
*/
orderjs.define("lib.dom.DomWrap",["lib.dom.engine"],function(){!function(){rl.dom.EventWrap=rl.createClass({construct:function(t){rl.isPrototyping(arguments[0])||t&&this.init(t)},members:{init:function(t){if(t=t||window.event,!t){for(var e=arguments.callee.caller;e&&(t=e.arguments[0],!t||Event!=t.constructor);)e=e.caller;!t&&this._evt&&(t=this._evt)}this._evt=t;var i=rl.util.CustomUIEventsMgr;return i&&(i.cancelBubble=!1),i&&(i.cancelDefault=!1),this},getEvt:function(){return this._evt},offsetX:function(){return this.offsetXY().X},offsetY:function(){return this.offsetXY().Y},offsetXY:function(){var t=this._evt,e=this.getTarget(),i=t.offsetX,n=t.offsetY;if(!rl.isDefined(i)){var s=rl.dom.getStyle(e,"position");if("relative"==s||"absolute"==s)i=t.layerX,n=t.layerY;else{var r,o;for(r=o=0;e;)r+=e.offsetLeft,o+=e.offsetTop,e=e.offsetParent;i=t.pageX-r,n=t.pageY-o}}return{X:i,Y:n}},clientX:function(){return this._evt.clientX},clientY:function(){return this._evt.clientY},pageX:function(){return this.pageXY().X},pageY:function(){return this.pageXY().Y},pageXY:function(){var t=this._evt;if(rl.isDefined(t.pageX))return{X:t.pageX,Y:t.pageY};var e=rl.dom.getWindowScrollXY();return{X:t.clientX+e.X,Y:t.clientY+e.Y}},screenX:function(){return this._evt.screenX},screenY:function(){return this._evt.screenY},wheelDelta:function(){return this._evt.wheelDelta||-40*this._evt.detail},button:function(){var t=this._evt,e=t.button;if(rl.IE)switch(e){case 1:return 0;case 4:return 1;case 0:return 2}return e},leftClick:function(){return 0==this.button()},keyCode:function(){var t=this._evt;return t.keyCode||t.which||0},type:function(){return this._evt.type},shiftKey:function(){return this._evt.shiftKey},ctrlKey:function(){return this._evt.ctrlKey},altKey:function(){return this._evt.altKey},getTarget:function(){var t=this._evt;return t.target?t.target:t.srcElement?t.srcElement:null},getRelatedTarget:function(){var t=this._evt,e=(t.type,t.relatedTarget);return e||("mouseover"==t.type?e=t.fromElement:"mouseout"==t.type&&(e=t.toElement)),e},setCapture:function(){var t=this.getTarget();return rl.isElement(t)&&(t.setCapture?t.setCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)),this},releaseCapture:function(){var t=this.getTarget();return rl.isElement(t)&&(t.releaseCapture?t.releaseCapture():window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP)),this},stopBubble:function(){var t=this._evt,e=rl.util.CustomUIEventsMgr,i=t.type.toLowerCase();return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,e&&(e.cancelBubble=!0),"mousedown"==i&&this.getTarget()!=document&&rl.dom.firePageFocusInEvent(t),this},stopDefault:function(){var t=this._evt,e=rl.util.CustomUIEventsMgr;return t.preventDefault?t.preventDefault():t.returnValue=!1,e&&(e.cancelDefault=!0),this},stopEvent:function(){return this.stopBubble(),this.stopDefault(),this},dispose:function(){delete this._evt},toString:function(){return"[object rl.dom.EventWrap]"}}}),rl.ew=new rl.dom.EventWrap}();var t=rl.dom;t.DomWrap=rl.createClass({construct:function(t){rl.isPrototyping(arguments[0])||(this.setTarget(t),this._toggleValues={})},members:{_commonToggleValues:{visibility:["visible","hidden"],display:["","none"]},hidden:!1,hiddenMode:"display",useVisibilityShow:!1,setTarget:function(t){return this.dom=rl.getDom(t),this},getDom:function(){return this.dom},getIndex:function(){var t=-1,e=this.dom;return rl.isElement(e)&&e.parentNode&&(t=Array.indexOf(function(t){return t==e},e.parentNode.childNodes)),t},getZIndex:function(){return this.getStyle("z-index",!0)},setZIndex:function(t){return this.dom.style.zIndex=t,this},show:function(){return this.useVisibilityShow?this.setVisibility(!0):this.dom.style.display="block",this.hidden=!1,this},hide:function(){return this.useVisibilityShow?this.setVisibility(!1):this.dom.style.display="none",this.hidden=!0,this},setVisibility:function(t){return t?(this.dom.style.visibility="visible",this.hidden=!1):(this.dom.style.visibility="hidden",this.hidden=!0),this},visible:function(){return"hidden"!=this.getStyle("visibility")&&this.displayed()},toggle:function(t,e,i){var n,s,r=this.getStyle(t);n=arguments.length>2?i===r?e:i:this.getToggleValue(t,r),s=t+":"+n,this.setStyle(s)},getToggleValue:function(t,e){var i=this._toggleValues[t]||this._commonToggleValues[t],n=i[1];return n===e?i[0]:n},regToggle:function(t,e,i){if(rl.isNonNullStr(t)){var n=this._toggleValues;n[t]=[e,i]}},displayed:function(){return"none"!=this.getStyle("display")},display:function(t){t=rl.isNonNullStr(t)?t.trim().toLowerCase():t===!1?"none":"";var e=this.getStyle("display");return e!==t&&(this.dom.style.display=t),this},setWidth:function(e){return this.dom.style.width=t.addUnit(e),this},getWidth:function(e){return t.getWidth(this.dom,e)},setHeight:function(e){return this.dom.style.height=t.addUnit(e),this},getHeight:function(e){return t.getHeight(this.dom,e)},setTop:function(e){return this.dom.style.top=t.addUnit(e),this},getInnerHeight:function(){var t=0;return Array.each(function(e){rl.isElement(e)&&(t+=e.offsetHeight)},this.dom.childNodes),t},getTop:function(e){return t.getStyle(this.dom,"top",e)},setLeft:function(e){return this.dom.style.left=t.addUnit(e),this},getLeft:function(e){return t.getStyle(this.dom,"left",e)},moveBy:function(t,e){t=parseInt(t),e=parseInt(e);var i=this.dom.style;if(!isNaN(t)){var n=this.getStyle("left",!0);i.left=n+t+"px"}if(!isNaN(e)){var s=this.getStyle("top",!0);i.top=s+e+"px"}return this},setXY:function(t,e,i){return i&&(t=this._calcLimit(!1,this.getWidth(),t),e=this._calcLimit(!0,this.getHeight(),e)),this.setLeft(t),this.setTop(e),this},moveTo:function(){return this.setXY.apply(this,arguments)},setStyle:function(e){return t.setStyle(this.dom,e),this},getStyle:function(e,i){return t.getStyle(this.dom,e,i)},getOffsetX:function(e){return t.getOffsetX(this.dom,e)},getOffsetY:function(e){return t.getOffsetY(this.dom,e)},getOffsetXY:function(e){return t.getOffsetXY(this.dom,e)},showAt:function(t,e,i){return this.show(),this.setXY(t,e,i),this},showAtEvent:function(t,e,i,n){e=parseInt(e),i=parseInt(i),isNaN(e)&&(e=0),isNaN(i)&&(i=0),rl.ew.init(t);var s=rl.ew.clientX()+e,r=rl.ew.clientY()+i;return this.showAt(s,r,n),this},alignTo:function(t,e,i){var n=t instanceof rl.dom.DomWrap?t:new rl.dom.DomWrap(t);if(!rl.isElement(n.dom))return rl.debug(this+"-> alignTo(): Invalid target!","warn"),this;var s,r,o,u,l=n.getOffsetXY(),h=l.X,a=l.Y,c=n.getWidth(!0),f=n.getHeight(!0),d=this.getWidth(!0),g=this.getHeight(!0);return rl.isNonNullStr(e)?(e=e.toUpperCase(),s=e.charAt(0),r=e.charAt(1)||"E",o=this._calcAlign(s,d,c,h),u=this._calcAlign(r,g,f,a)):(s="B",r="E",o=h,u=a+f),i&&(o=this._calcLimit(!1,d,o,h,"A"==r||"E"==r),u=this._calcLimit(!0,g,u,a,"A"==s||"E"==s)),this.setXY(o,u),this},offsetAt:function(t,e,i,n){var s=t,r=e;return i>0&&(s=this._calcLimit(!1,this.getWidth(),t),s=t>s?s-i:s+i),n>0&&(r=this._calcLimit(!0,this.getHeight(),e),r=e>r?r-n:r+n),this.setLeft(s),this.setTop(r),this},_calcAlign:function(t,e,i,n){var s;switch(t){case"A":s=n-e;break;case"B":s=n;break;case"C":s=n+i/2;break;case"D":s=n+i-e;break;default:s=n+i}return s},_calcLimit:function(t,e,i,n,s){var r,o,u=rl.dom.viewport[t?"getDocumentHeight":"getDocumentWidth"]();return o=i+e,o>u?(s&&(i=u,n=i),r=isNaN(n)?i-e:i-e-(i-n)):r=i,r},within:function(t){return this.dom==t||rl.dom.childOf(t,this.dom)},upto:function(t,e){return rl.dom.findParentBy(this.dom,t,e)},isTag:function(t){var e=this.dom;return rl.isElement(e)&&e.tagName.equalsIgnoreCase(t)},hasAttribute:function(t){var e=this.dom;return rl.isElement(e)&&(rl.support.dom_hasAttribute?e.hasAttribute(t):null!=e.getAttribute(t))},hasClass:function(e){return t.hasClass(this.dom,e)},addClass:function(e){return t.addClass(this.dom,e),this},removeClass:function(e){return t.removeClass(this.dom,e),this},on:function(e,i,n,s){return t.addEventListener(this.dom,e,i,n,s),this},un:function(e,i,n){return t.removeEventListener(this.dom,e,i,n),this},getText:function(){return t.getText(this.dom)},setText:function(e){return t.setText(this.dom,e),this},setInnerHTML:function(e,i){return t.setInnerHTML(this.dom,e,i),this},focus:function(){return this.visible()||this.focused?this:(this.focused=!0,this.dom.focus(),this)},blur:function(){return this.visible()||!this.focused?this:(this.focused=!1,this.dom.blur(),this)},onDispose:function(){this.animation&&(this.animation.dispose(),delete this.animation),rl.isElement(this.dom)&&(rl.dom.destroyElements(this.dom),delete this.dom)},dispose:function(){return this._disposed?this:(rl.isFunction(this.onDispose)&&this.onDispose(),this._disposed=!0,this)},toString:function(){return"[object rl.dom.DomWrap]"}}}),rl.DomWrap=rl.dom.DomWrap,rl.dw=new rl.DomWrap,rl.$=function(){return rl.dw.setTarget.apply(rl.dw,arguments)}});