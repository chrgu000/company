orderjs.define("gui.tab.TabPanel",["gui.engine","gui.menu.Menu","gui.menu.PopupMenu","gui.box.Div","gui.Iframe","css>rl:tabpanel"],function(){rl.gui.tab.Tab=rl.createClass({parent:rl.gui.menu.MenuItem,construct:function(t,e,i){rl.isPrototyping(arguments[0])||rl.gui.tab.Tab.parent.call(this,t,e,i)},members:{initHeight:22,minWidth:50,maxWidth:200,autoTip:!0,autoIdPrefix:"tab_",hasIcon:!1,hasCloseIcon:!1,showNormalStateBorder:!0,closeActionEventName:"click",skinCss:"page_tab",_interactiveStateCssPrefix:"rl_tab_",closeAction:null,_htmlTpl:new rl.HtmlTpl('<TABLE class="rl_btn rl_menuitem rl_tab {btnBorderCss}"  id="{id}" title="{tip}" cellSpacing=0 cellPadding=0 border=0><TBODY class="{skinCss}"><TR><TD class="rl_btn_left" ><i>&nbsp;</i></TD><TD class="rl_btn_center btn_txt"><button class="{iconCss}" type="button" style="height:{ctrlHeight};{iconBg};"><span class="txt_ctn">{text}</span></button></TD><TD class="rl_btn_center close_icon_ctn" style="{ciDisplay}"><img class="close_icon" src="'+rl.gui.URL_BLANK_IMG+'" /></TD><TD class="rl_btn_right"><i>&nbsp;</i></TD></TR></TBODY></TABLE>'),initView:function(t){var e="",i=this.hasCloseIcon?"":"display:none;",r="",n=parseInt(this.initHeight),s=this.showNormalStateBorder?"":"rl_tab_no_border";rl.isNonNullStr(this.id)||(this.id=this.autoId()),this.hasIcon&&rl.isNonNullStr(this.icon)&&(r="with_icon",""===this.text&&(r+=" icon_only"),e="background-image: url("+this.icon+");");var a=this._htmlTpl.renderTo(t,{id:this.id,text:this.text,tip:this.tip||this.text,skinCss:this.skinCss,ctrlHeight:n+"px",iconBg:e,ciDisplay:i,iconCss:r,btnBorderCss:s},this.renderPosition);this.dw.setTarget(a)},initEvents:function(){var t=this._getCloseIcon();if(rl.isElement(t)){var e=rl.dw.setTarget(t);e.on("mouseover",this.hndCloseIconMouseover,this),e.on("mouseout",this.hndCloseIconMouseout,this),e.on("mousedown",this.hndCloseIconMousedown,this),e.on("mouseup",this.hndCloseIconMouseup,this),e.on(this.closeActionEventName,this.hndCloseActionEvent,this)}rl.gui.tab.Tab.parent.prototype.initEvents.call(this)},_getTextCtn:function(){return this._ctrlEle.firstChild},setIcon:function(t){if(this.hasIcon&&rl.isString(t)){var e=this.icon;rl.isNonNullStr(t)?(rl.isNonNullStr(e)||this.showIcon(),rl.gui.tab.Tab.parent.prototype.setIcon.call(this,t)):(this.hideIcon(),this.icon="")}return this},showIcon:function(){return this.hasIcon&&rl.$(this._ctrlEle).addClass("with_icon"),this},hideIcon:function(){return this.hasIcon&&rl.$(this._ctrlEle).removeClass("with_icon"),this},updateView:function(t){if(!this._rendered)return this;var e,i,r;return rl.isNonNullStr(t)?(e=arguments[0],i=arguments[1],r=arguments[2]):rl.isObject(t)&&(e=t.text,i=t.icon,r=t.tip),this.setText(e),this.setIcon(i),this.setTip(r),this},_updateWidth:function(){var t=this.dw.dom;t&&(t.offsetWidth?this._updateTabWidth():Function.defer(this._updateTabWidth,this))},_updateTabWidth:function(){/%/.test(this.width)?this._fit2CtnWidth():this._fit2TextWidth()},_getCloseIcon:function(){return this.dw.dom.getElementsByTagName("img")[0]},_getCloseIconCtn:function(){return this._getCloseIcon().parentNode},clear:function(){},setWidth:function(){var t,e=this.dw.dom,i=e.offsetWidth;if(rl.gui.tab.Tab.parent.prototype.setWidth.apply(this,arguments),t=e.offsetWidth,t!=i){var r=this.owner;r&&r.hndItemSizeChange&&r.hndItemSizeChange(this,"width",t,i),this.fireEvent("sizechange","width",t,i)}return this},showCloseIcon:function(){if(!this.hasCloseIcon)return this;var t=this._getCloseIconCtn();if(rl.isElement(t)){var e,i=this.dw.dom,r=i.offsetWidth;if(t.style.display="",e=i.offsetWidth,e!=r){var n=this.owner;n&&n.hndItemSizeChange&&n.hndItemSizeChange(this,"width",e,r),this.fireEvent("sizechange","width",e,r)}}return this},hideCloseIcon:function(){if(!this.hasCloseIcon)return this;var t=this._getCloseIconCtn();if(rl.isElement(t)){var e,i=this.dw.dom,r=i.offsetWidth;if(t.style.display="none",e=i.offsetWidth,e!=r){var n=this.owner;n&&n.hndItemSizeChange&&n.hndItemSizeChange(this,"width",e,r),this.fireEvent("sizechange","width",e,r)}}return this},hndCloseIconMouseover:function(t){if(!this.disabled){var e=rl.ew.init(t).getTarget();rl.$(e).addClass("close_icon_over")}},hndCloseIconMouseout:function(t){if(!this.disabled){var e=rl.ew.init(t).getTarget();rl.$(e).removeClass("close_icon_over").removeClass("close_icon_down")}},hndCloseIconMousedown:function(t){if(!this.disabled){var e=rl.ew.init(t).getTarget();rl.$(e).addClass("close_icon_down")}},hndCloseIconMouseup:function(t){if(!this.disabled){var e=rl.ew.init(t).getTarget();rl.$(e).removeClass("close_icon_down")}},hndCloseActionEvent:function(t){if(this.disabled)return!1;if(rl.ew.init(t).stopBubble(),rl.isFunction(this.closeAction))this.closeAction();else{var e=this.owner;e&&rl.isFunction(e.hndItemCloseAction)&&e.hndItemCloseAction(this)}return!1},toString:function(){return"[object rl.gui.tab.Tab]"}}}),rl.gui.tab.BTab=rl.createClass({parent:rl.gui.tab.Tab,construct:function(t,e,i){rl.isPrototyping(arguments[0])||rl.gui.tab.BTab.parent.call(this,t,e,i)},members:{iniHeight:28,skinCss:"page_btab",toString:function(){return"[object rl.gui.tab.BTab]"}}}),rl.gui.tab.TabBar=rl.createClass({parent:rl.gui.menu.Menu,construct:function(t){rl.isPrototyping(arguments[0])||rl.gui.tab.TabBar.parent.call(this,t)},members:{TYPE:"TabBar",itemType:rl.gui.tab.Tab,_menuCss:"rl_tabbar",_showingScrollers:!1,enableDblclick2Close:!0,autoRenderOnReady:!1,defAutoScrollTranslation:10,fScrollerStart:0,bScrollerStart:0,scrollIconSrc_B:rl.gui.imgPM.mapping("tabpanel/arrow_left.gif"),scrollIconSrc_B_Dis:rl.gui.imgPM.mapping("tabpanel/arrow_left_disabled.gif"),scrollIconCss_B:"scroller_b",scrollIconSrc_F:rl.gui.imgPM.mapping("tabpanel/arrow_right.gif"),scrollIconSrc_F_Dis:rl.gui.imgPM.mapping("tabpanel/arrow_right_disabled.gif"),scrollIconCss_F:"scroller_f",_tabBarStyleCss:"rl_page_tabbar",_htmlTpl:new rl.HtmlTpl('<div id="{id}" class="rl_comp rl_menu {css} {tabBarStlCss}" style="width:{width};"><div class="rl_tab_ctn_wrap" id="{tabWrapId}" style="left:{wrapLeft};"><div id="{tabCtnId}" class="rl_tab_ctn"><div><div></div>'),render:function(t){if(this.loadDataBeforeRender)return this.loadDataBeforeRender=!1,this._loadingDataForRender=!0,this.load(),this;if(this._loadingDataForRender)return this;if(this._rendered)return this;t=this.getRenderTarget(t),this.id||(this.id=this.autoId()),this.tabWrapId=this.id+"_tabWrap",this.tabCtnId=this.id+"_tabCtn";var e,i,r,n=rl.dom.addUnit;return i=this.bScrollerStart,e=this._htmlTpl.renderTo(t,{id:this.id,tabWrapId:this.tabWrapId,tabCtnId:this.tabCtnId,css:this._menuCss,tabBarStlCss:this._tabBarStyleCss,wrapLeft:this.bScrollerStart+"px",width:n(this.width)},this.renderPosition),r=e.offsetWidth-this.bScrollerStart-this.bScrollerStart,rl.getDom(this.tabWrapId).style.width=r+"px",this.dw.setTarget(e),rl.gui.makeUnselectable(e,!0),this._renderItems(),this._rendered=!0,this.fireEvent("render"),this},_createScrollers:function(t){var e=this.dw.dom;if(e){var i,r=t?"_F":"_B",n=t?"fScrollerAction":"bScrollerAction",s=this["scrollIconSrc"+r],a=this["scrollIconSrc"+r+"_Dis"],o=this["scrollIconCss"+r];i=new this.itemType({renderTarget:e,autoRenderOnReady:!0,disabled:!0,icon:s,disabledIcon:a});var l=i.dw,h=l.dom.style;return l.addClass(o),t?h.right=this.fScrollerStart+"px":h.left=this.bScrollerStart+1+"px",l.on("mousedown",this[n],this),l.on("mouseout",this._stopScroll,this),l.on("mouseup",this._stopScroll,this),i}},fScrollerAction:function(){this.scrollerAction(!0)},bScrollerAction:function(){this.scrollerAction(!1)},doScroll:function(t,e){if(this.itemsOverflowed){var i=rl.getDom(this.tabCtnId);if(rl.isElement(i)){var r,n=this.bScroller,s=this.fScroller;e=e||this.defAutoScrollTranslation,r=this._moveBar(t,e),r?t?n.enable():s.enable():(this.cancelAutoScroll(),t?this.hndScroll2End():this.hndScroll2Begin())}}},_autoScroll:function(t){this._autoScrollTimer=Function.interval(this.doScroll,20,this,t)},_stopScroll:function(){this.cancelAutoScroll(),this._stopAutoScrollBar()},_stopAutoScrollBar:function(){window.clearInterval(this._autoScrollTimer)},scrollerAction:function(t){this._delayAutoScrollTimer&&this.cancelAutoScroll(),this._autoScroll(t)},cancelAutoScroll:function(){window.clearTimeout(this._delayAutoScrollTimer),this._delayAutoScrollTimer=null},_moveBar:function(t,e){if(this.itemsOverflowed){var i=rl.getDom(this.tabCtnId);if(rl.isElement(i)){var r,n,s,a,o,l;return e=isNaN(e)?0:Math.abs(e),t&&(e=-e),n=rl.$(i),l=n.getLeft(!0)+e,0>l?(s=this._getItemsWrapWidth(),a=this._getItemsWidth(),o=a-s,0>o+l?l=-o:r=!0):l=0,n.setLeft(l),r}}},_renderItem:function(t){t.appendDomTo(this.tabCtnId),this.hndItemsWidthChange()},afterAdd:function(t,e,i){rl.gui.tab.TabBar.parent.prototype.afterAdd.call(this,t,e,i),t._rendered&&this.hndItemsWidthChange()},afterRemove:function(t){rl.gui.tab.TabBar.parent.prototype.afterRemove.call(this,t),t._rendered&&this.hndItemsWidthChange(),this._lastActiveItem==t&&(this._unMarkActiveItem(t),delete this._lastActiveItem)},setActive:function(t){if(!this.items.contains(t)||t.disabled)return!1;var e=this._lastActiveItem;if(e){if(e==t)return!0;this._unMarkActiveItem(e)}return this._markActiveItem(t),this._lastActiveItem=t,this.scrollItemIntoView(t),this.fireEvent("activechange",t,e),!0},getActive:function(){return this._lastActiveItem},setWidth:function(t){return this.width=t,this.dw.dom&&(this.dw.setWidth(t),this.hndWidthChange(),this._lastUpdatedWidth=this.dw.dom.offsetWidth),this},setHeight:function(){return this},checkScroll:function(){var t=rl.getDom(this.tabCtnId);if(rl.isElement(t)){var e,i,r,n,s;e=rl.$(t),s=e.getLeft(!0),0>s&&(i=this._getItemsWrapWidth(),r=this._getItemsWidth(),n=r-i,0>n?t.style.left=0:0>n+s&&(t.style.left=-n+"px"))}},checkOverflow:function(){var t=rl.getDom(this.tabCtnId);if(rl.isElement(t)){var e=this._getItemsWrapWidth(),i=this._getItemsWidth();i>e?(this.itemsOverflowed=!0,this.showScrollers(),this.updateScrollersStates(),this.fireEvent("overflow")):(this.itemsOverflowed=!1,this.hideScrollers())}},showScrollers:function(){this.itemsOverflowed&&(this.bScroller||(this.bScroller=this._createScrollers(!1)),this.fScroller||(this.fScroller=this._createScrollers(!0)),this.bScroller.show(),this.fScroller.show(),this.updateItemsWrapView())},hideScrollers:function(){this.bScroller&&this.fScroller&&(this.bScroller.hide(),this.fScroller.hide(),this.updateItemsWrapView())},updateItemsWrapView:function(){var t=rl.getDom(this.tabWrapId);if(rl.isElement(t)){var e,i,r,n;i=r=this.dw.dom.offsetWidth,e=this.bScrollerStart,i-=this.bScrollerStart+this.fScrollerStart,this.itemsOverflowed&&(n=this.getScrollersWidth(),e+=n/2,i-=n),rl.$(t).setLeft(e).setWidth(i),rl.debug("updateItemsWrapView totalWidth = "+r+" width = "+i+" left = "+e)}},getScrollersWidth:function(){return this._scrollersWidth||(this._scrollersWidth=this.bScroller.dw.dom.scrollWidth+this.fScroller.dw.dom.scrollWidth),this._scrollersWidth},updateScrollersStates:function(){if(this.itemsOverflowed){var t=rl.getDom(this.tabCtnId);if(rl.isElement(t)){var e,i=this._getItemsWrapWidth(),r=this._getItemsWidth(),n=this.getScrollersWidth(),s=rl.$(t).getLeft(!0),a=this.bScroller,o=this.fScroller;a&&(0>s?a.enable():a.disable()),o&&(isNaN(s)&&(s=0),e=s+r+n,e>i?o.enable():o.disable())}}},scrollItemIntoView:function(t){if(this.itemsOverflowed){var e=rl.getDom(this.tabCtnId);if(rl.isElement(e)&&t&&t.dw&&(ele=t.dw.dom,rl.isElement(ele))){var i,r,n=this._getItemsWrapWidth(),s=this.getScrollersWidth(),a=rl.$(e).getLeft(!0),o=ele.offsetLeft,l=ele.offsetWidth;if(0>a+o)r=Math.abs(a+o)+10,this._moveBar(!1,r),this.updateScrollersStates();else if(i=o+l+a,n-=s,i>n){var h=i-n;r>h&&(r=h),r=-(i-n)-10,this._moveBar(!0,r),this.updateScrollersStates()}}}},closeItem:function(t){var e=this.items.indexOf(t);return 0>e||this.fireEvent("beforeitemclose",t)===!1?this:(this.removeAt(e),t.clear(),t.removeDom(),this.fireEvent("itemclose",t),this)},createItem:function(t){return new this.itemType(t)},_getItemsCtn:function(){return rl.getDom(this.tabCtnId)},_markActiveItem:function(t){t.active(),t.dw.addClass("active_tab"),t.showCloseIcon()},_unMarkActiveItem:function(t){t.inactive(),t.dw.removeClass("active_tab"),t.hideCloseIcon()},_getItemsWidth:function(){return this._itemsWidthChanged&&this._updateItemsWidth(),this._itemsWidth},_updateItemsWidth:function(){var t=0,e=rl.GECKO?0:-1;return this.each(function(i){i.dw.dom&&(t+=i.dw.dom.offsetWidth+e)}),this._itemsWidth=t,this._itemsWidthChanged=!1,t},_getItemsWrapWidth:function(){var t=rl.getDom(this.tabWrapId);return t?t.offsetWidth:0},_adjustTabCtnWidth:function(){var t=rl.getDom(this.tabCtnId);if(rl.isElement(t)){var e=this._getItemsWidth();if(e){var i=1e3;t.style.width=String(e+i)+"px"}}},hndScroll2Begin:function(){this._stopAutoScrollBar(),this.bScroller&&this.bScroller.disable()},hndScroll2End:function(){this._stopAutoScrollBar(),this.fScroller&&this.fScroller.disable()},hndItemSizeChange:function(t,e){"width"==e&&this.hndItemsWidthChange()},hndItemsWidthChange:function(){this._itemsWidthChanged=!0,this._adjustTabCtnWidth(),this.checkOverflow(),this.checkScroll()},hndWidthChange:function(){this.updateItemsWrapView(),this.checkOverflow(),this.checkScroll()},hndWindowWidthChange:function(){var t=this.dw.dom;if(t){var e=this._lastUpdatedWidth,i=t.offsetWidth;e!=i&&this.hndWidthChange(),this._lastUpdatedWidth=i}},hndItemMousedown:rl.EMPTY_FUNCTION,hndItemCloseAction:function(t){var e=this.tabPanel;return e&&e.hndTabBarItemCloseAction?e.hndTabBarItemCloseAction(t):void this.closeItem(t)},toString:function(){return"[object rl.gui.tab.TabBar]"}}}),rl.gui.tab.BTabBar=rl.createClass({parent:rl.gui.tab.TabBar,construct:function(t,e,i){rl.isPrototyping(arguments[0])||rl.gui.tab.BTabBar.parent.call(this,t,e,i)},members:{_tabBarStyleCss:"rl_page_btabbar",itemType:rl.gui.tab.BTab,toString:function(){return"[object rl.gui.tab.BTabBar]"}}}),rl.gui.tab.TabBody=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.tab.TabBody.parent.call(this,t),this.initialize())},members:{isFrame:!0,frameListener:null,content:void 0,isHtmlContent:void 0,initialize:function(){var t,e,i=this.content;this.isFrame?(t="Iframe",e={id:this.id,name:this.frameName,contentWindowListener:this.frameListener,src:i}):(t="Div",e={isHtmlContent:this.isHtmlContent,content:i}),rl.ext(e,{autoRenderOnReady:this.autoRenderOnReady,renderTarget:this.renderTarget}),this.view=new rl.gui[t](e),this.dw=this.view.dw},render:function(t){if(this._rendered)return this;var e=this.owner;return this.view.render(t,this.renderPostion),e&&e.hndItemRender&&e.hndItemRender(this),this._rendered=!0,this.fireEvent("render"),this},setContent:function(t,e){var i=this.view;return i&&(this.isFrame?i.open(t):i.setContent(t,e)),this.content=t,this},clear:function(){this.view;this.isFrame?this.setContent("about:blank"):this.setContent("",!0)},updateView:function(t){var e=t;return rl.isObject(t)&&(e=t.content),this.setContent(e),rl.debug(this+"updateView content = "+e),this},getFrameWindow:function(){return this.isFrame?this.view.getContentWindow():void 0},refreshFrameWindow:function(){try{this.isFrame&&this.getFrameWindow().location.reload()}catch(t){rl.dir(t,this+" error")}},onDispose:function(){this.view.dispose(),delete this.view,this.dw.dispose(),delete this.dw},toString:function(){return"[object rl.gui.tab.TabBody]"}}}),rl.gui.tab.TabBodyStack=rl.createClass({parent:rl.gui.ContainerBase,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.tab.TabBodyStack.parent.call(this,t),this.initialize())},members:{items:null,frameItemListener:null,enableItemCache:!1,itemType:rl.gui.tab.TabBody,_htmlTpl:new rl.HtmlTpl('<div class="rl_comp rl_tabbody_stack"><div class="tabbody_wrap"></div></div>'),initialize:function(){var t=this.items;this.items=[],this._namedItemsStore={},this.dw=new rl.dom.DomWrap,rl.isArray(t)&&(t=this.initItems(t),this.addItems(t)),this.autoRenderOnReady&&rl.onReady(Function.bind(this.render,this))},initItems:function(t){var e;if(rl.isArray(t))for(var i=0,r=t.length;r>i;i++)t[i]||t.removeAt(i),i--,r--;return Array.map(function(t){return t instanceof rl.gui.ComponentBase?t:new(e=rl.isObject(t)?this.getItemType(t.ctype):this.itemType)(t)},t,this)},render:function(t){if(this._rendered)return this;t=this.getRenderTarget(t);var e=this._htmlTpl.renderTo(t,null,this.renderPosition);return this.dw.setTarget(e),this._renderItems(),this._rendered=!0,this.fireEvent("render"),this},setActive:function(t){if(!this.items.contains(t)||t.disabled)return!1;var e=this._lastActiveItem;if(e){if(e==t)return!0;this._unMarkActiveItem(e)}return this._markActiveItem(t),this._lastActiveItem=t,this.fireEvent("activechange",t,e),!0},getActive:function(){return this._lastActiveItem},_markActiveItem:function(t){t.dw.addClass("active_body")},_unMarkActiveItem:function(t){t.dw.removeClass("active_body")},afterAdd:function(t){var e=t.owner;e instanceof rl.gui.ContainerBase&&rl.isFunction(e.remove)&&e.remove(t),t.owner=this,this._rendered&&this._renderItem(t)},afterRemove:function(t){delete t.owner,t._rendered&&t.dw.removeClass("rl_tabbody_item"),t.removeDom(),this._lastActiveItem==t&&(this._unMarkActiveItem(t),delete this._lastActiveItem)},_renderItems:function(){Array.each(this._renderItem,this.items,this)},_renderItem:function(t){t.appendDomTo(this.dw.dom.firstChild),t._rendered&&t.dw.addClass("rl_tabbody_item")},hndItemRender:function(t){t.dw.addClass("rl_tabbody_item")},closeItem:function(t){var e;return e=this.items.indexOf(t),0>e||this.fireEvent("beforeitemclose",t)===!1?this:(this.removeAt(e),t.dispose(),this.fireEvent("itemclose",t),this)},createItem:function(t){return new this.itemType(t)},toString:function(){return"[object rl.gui.tab.TabBodyStack]"}}}),rl.gui.tab.TabPanelItem=rl.createClass({parent:rl.gui.ComponentBase,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.tab.TabPanelItem.parent.call(this,t),this.initialize())},members:{closable:!0,initialize:function(){rl.isNonNullStr(this.id)||(this.id=this.autoId())},close:function(){return this.fireEvent("beforeclose")===!1?!1:this.owner.closeItem(this)?(this.fireEvent("close"),!0):!1},hndPagePropertyChange:function(t,e){var i=this.head;if(i&&rl.page)if("title"===t)i.setText(e);else if("icon"===t){{rl.page.defaultPageIcon||""}i.setIcon(e)}else if("status"===t){var r=rl.page.defaultPageIcon,n=rl.page.defaultPageLoadingIcon;"unload"===e||"init"===e?i.setIcon(n):"load"===e&&i.getIcon()==n&&i.setIcon(r)}},updateView:function(t){this.head&&this.head.updateView(t),this.body&&this.body.updateView(t)},onDispose:function(){delete this.head,delete this.body},toString:function(){return"[object rl.gui.tab.TabPanelItem]"}}}),rl.gui.tab.TabPanel=rl.createClass({parent:rl.gui.ContainerBase,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.tab.TabPanel.parent.call(this,t),this.initialize())},members:{itemType:rl.gui.tab.TabPanelItem,listenFrameItem:!0,showHeadBarContextmenu:!0,frameItemListener:null,headBarCfg:null,headBarType:rl.gui.tab.TabBar,bodyStackCfg:null,bodyStackType:rl.gui.tab.TabBodyStack,autoRenderOnReady:!0,enableDblclick2Close:!0,itemDefault_isHtmlContent:!1,itemDefault_isFrame:!0,openPosition:"nextto",defaultOpenActive:!0,activateAfterClose:"previousto",_htmlTpl:new rl.HtmlTpl('<table id="{id}" class="rl_comp rl_tabpanel" border="0" cellspacing="0" cellpadding="0"><tr><td id="{headBarCtnId}" class="head_bar_ctn"></td></tr><tr><td id="{bodyCtnCtnId}" class="body_stack_ctn"></td></tr></table>'),initialize:function(){var t=this.items;this.items=[],this._namedItemsStore={},this._cachedFramesStore=[],this.dw=new rl.dom.DomWrap,this.id||(this.id=this.autoId()),this._headBarCtnId=this.id+"_headBarCtn",this._bodyCtnCtnId=this.id+"_bodyCtnCtn",rl.gui.compStore.add(this.id,this),this.listenFrameItem&&!this.frameItemListener&&(this.frameItemListener={handler:this.hndFrameItemLoad,scope:this}),this.createHeadBar(),this.createBodyCtn(),this.showHeadBarContextmenu&&this.createHeadBarContextmenu(),rl.isArray(t)&&(t=this.initItems(t),this.addItems(t)),this.autoRenderOnReady&&rl.onReady(Function.bind(this.render,this))},initItems:function(t){if(rl.isArray(t))for(var e=0,i=t.length;i>e;e++)t[e]||t.removeAt(e),e--,i--;return Array.map(function(t){return t instanceof rl.gui.ComponentBase?t:this.createItem(t)},t,this)},initEvents:function(){var t=this.headBar.dw;t.on("dblclick",this.hndHeadBarDblclick,this),this.showHeadBarContextmenu&&t.on("contextmenu",this.hndHeadBarContextmenu,this),t.on("mousedown",this.hndHeadBarMousedown,this)},initFirstActive:function(){var t,e=this.items;t=Array.find(function(t){return t&&t.iniActive?t:void 0},e,this),this.setActive(t)},render:function(t){if(this._rendered)return this;t=this.getRenderTarget(t);var e=this._htmlTpl.renderTo(t,{id:this.id,headBarCtnId:this._headBarCtnId,bodyCtnCtnId:this._bodyCtnCtnId},this.renderPosition);return this.headBar.render(),this.bodyCtn.render(),this.showHeadBarContextmenu&&this.headBarContextmenu.render(),this.dw.setTarget(e),this.initEvents(),this._renderItems(),this.initFirstActive(),this._rendered=!0,this.fireEvent("render"),this},createHeadBar:function(){var t,e=this.headBarType,i=rl.ext({autoRenderOnReady:!1,tabPanel:this,renderTarget:this._headBarCtnId},this.headBarCfg);t=new e(i),this.headBar=t},createHeadBarContextmenu:function(){var t=Function.bind(this.closeCurrent,this),e=Function.bind(this.closeOthers,this),i=(Function.bind(this.closeAll,this),Function.bind(this.refreshFrame,this)),r=rl.getG11nSource("rl.gui.tab.TabPanel"),n=new rl.gui.menu.PopupMenu({items:[{text:r.refresh,icon:rl.gui.mapIcon("refresh.gif"),action:i},{ctype:"MenuSplit"},{id:this.id+"closeCurrent",text:r.close,action:t},{text:r.closeOthers,action:e}]});this.headBarContextmenu=n},createBodyCtn:function(){var t=this.bodyStackType,e=rl.ext({autoRenderOnReady:!1,tabPanel:this,frameItemListener:this.frameItemListener,renderTarget:this._bodyCtnCtnId},this.bodyStackCfg);this.bodyCtn=new t(e)},afterAdd:function(t,e,i){var r=t.owner;r instanceof rl.gui.ContainerBase&&rl.isFunction(r.remove)&&r.remove(t),t.owner=this,this._rendered&&(rl.debug("afterAdd index = "+i),this.headBar.insertAt(t.head,i),this.bodyCtn.add(t.body))},remove:function(t,e){return rl.gui.tab.TabBar.parent.prototype.remove.call(this,t,e)},setActive:function(t){if(!this.items.contains(t)||t.disabled)return!1;var e=this._lastActiveItem;return e&&e==t?!0:(this.headBar.setActive(t.head),this.bodyCtn.setActive(t.body),this._lastActiveItem=t,this.fireEvent("activechange",t,e),!0)},getActive:function(){return this._lastActiveItem},setWidth:function(t){var e=this.dw,i=e.dom,r=this.headBar;return i&&(e.setWidth(t),r&&r.setWidth(t)),this.width=t,this},setHeight:function(t){var e=this.dw,i=e.dom;if(i){if(rl.IE&&(headBar=this.headBar,!/auto|%/i.test(t)&&headBar&&headBar.dw)){var r=headBar.dw.dom;r&&(t=parseInt(t)-r.offsetHeight)}e.setHeight(t)}return this.height=t,this},open:function(t,e){if(!this._rendered)throw{description:this+" -> open(): method can only be invoked afterthis is rendered"};var i,r,n,s,a=!this._lastActiveItem,o=this.items;return rl.isObject(e)||(e={}),rl.isObject(t)||(t={content:t}),a||(a=e.active===!1?!1:this.defaultOpenActive),s=t.id,rl.isNonNullStr(s)&&(n=this.getItemById(s)),n?n.updateView(t):(r=(e.openPosition||this.openPosition).toLowerCase(),rl.debug("pos = "+r),this._lastActiveItem&&"current"==r?this._lastActiveItem.updateView(t):(n=this.createItem(t),"nextto"==r?i=o.indexOf(this._lastActiveItem)+1:r.contains("before")&&(s=r.split(":")[1],i=o.indexOf(this.getItemById(s))),rl.debug("index = "+i),this.insertAt(n,i))),a&&this.setActive(n),n},closeItem:function(t){return this.items.contains(t)&&t.closable?this.fireEvent("beforeitemclose",t)===!1?!1:(this._lastActiveItem==t&&(delete this._lastActiveItem,this.activateAnother(t)),t=this.remove(t),this.headBar.closeItem(t.head),this.bodyCtn.closeItem(t.body),this.fireEvent("itemclose",t),!0):!1},activateAnother:function(t){var e,i=this.activateAfterClose.toLowerCase();"nextto"==i?e=this.getNextItem(t)||this.getPreviousItem(t):"previousto"==i&&(e=this.getPreviousItem(t)||this.getNextItem(t)),rl.debug("newActive = "+e),e&&this.setActive(e)},closeCurrent:function(){var t=this._headBarContextItem||this._lastActiveItem;return this.closeItem(t)},closeOthers:function(){var t=this._headBarContextItem||this._lastActiveItem;return this._closeAllExcept(t)},closeAll:function(){return this._closeAllExcept()},_closeAllExcept:function(){for(var t=0,e=this.items,i=Array.slice(arguments,0),r=e[t],n=[];r;)i.contains(r)||!this.closeItem(r)?t+=1:n.push(r),r=e[t];return n},refreshFrame:function(){var t,e=this._headBarContextItem||this._lastActiveItem;e&&(t=e.body,t&&t.refreshFrameWindow())},createItem:function(t){rl.isObject(t)||(t={});var e,i,r,n,s,a,o,l=(this.itemType.prototype,t.id||rl.autoId());return this.headBar&&(n={id:l+"_tabHead",text:t.text,icon:t.icon,tip:t.tip,hasCloseIcon:t.closable},i=this.headBar.createItem(n)),this.bodyCtn&&(a=t.isHtmlContent||this.itemDefault_isHtmlContent,o=t.isFrame||this.itemDefault_isFrame,s={id:l+"_tabBody",content:t.content,isHtmlContent:a,isFrame:o,frameListener:this.frameItemListener},o&&(s.frameName=l),r=this.bodyCtn.createItem(s)),rl.ext(t,{head:i,body:r}),e=new this.itemType(t),e.head.panelItem=e,e.body.panelItem=e,rl.dir(t,"config"),rl.debug("config.closable = "+t.closable),e},findItemByPageName:function(t){return rl.isNonNullStr(t)?this.find(function(e){try{{e.body.dw.dom}return e.body.dw.dom.name==t}catch(i){}}):null},findItemByPageElement:function(t){return rl.$(t).isTag("iframe")?this.find(function(e){try{return e.body.dw.dom==t}catch(i){}}):null},_renderItems:function(){Array.each(this._renderItem,this.items,this)},_renderItem:function(t){this.headBar.add(t.head),this.bodyCtn.add(t.body)},_blurHeadBarItem:function(t){try{var e=t.dw.dom.getElementsByTagName("button")[0];Function.defer(function(){e.blur()})}catch(i){}},hndFrameItemLoad:function(){},hndHeadBarDblclick:function(t){var e=this.headBar.getItemByEvent(t);e&&this.enableDblclick2Close&&this.closeItem(e.panelItem)},hndHeadBarMousedown:function(t){var e=this.headBar.getItemByEvent(t);e&&(this._blurHeadBarItem(e),rl.ew.init(),0==rl.ew.button()&&this.setActive(e.panelItem))},hndTabBarItemCloseAction:function(t){return t&&this.closeItem(t.panelItem),!1},hndHeadBarContextmenu:function(t){var e=this.headBarContextmenu;e.showAtEvent(t),rl.ew.stopDefault();var i=this.headBar.getItemByEvent(t);if(i){this._blurHeadBarItem(i);var r=i.panelItem;this._headBarContextItem=r;var n=e.getItemById(this.id+"closeCurrent");n&&n.setEnable(r.closable)}else this._headBarContextItem=null},toString:function(){return"[object rl.gui.tab.TabPanel]"}}}),rl.gui.ctype2Classes.add("TabPanel",rl.gui.tab.TabPanel),rl.gui.tab.tabFrameMgr=function(){function t(t){var e,i="/";return rl.IE&&rl.VER_IE<7&&t.contains("\\")&&(i="\\"),e=t.split(i),text=e[e.length-1],text.bLen()>20&&(text=text.bSubstring(0,20)+"..."),text}var e="rl_frame_name_";return{tabPanelProxy:null,findItemByPageElement:function(){var t=rl.gui.tab.tabFrameMgr.tabPanelProxy;return t&&rl.isFunction(t.findItemByPageElement)?t.findItemByPageElement.apply(t,arguments):void 0},findItemByPageName:function(){var t=rl.gui.tab.tabFrameMgr.tabPanelProxy;return t&&rl.isFunction(t.findItemByPageName)?t.findItemByPageName.apply(t,arguments):void 0},open:function(i,r,n){var s=rl.gui.tab.tabFrameMgr.tabPanelProxy;if(!s)return null;var a;return n=n||{},rl.isString(r)&&(r=r.trim().toLowerCase()),rl.isNonNullStr(r)||(r=rl.autoId(e)),a={id:r,text:n.text||t(i),icon:n.icon,content:i,closable:n.closable===!1?!1:!0},s.open(a,n)}}}()});