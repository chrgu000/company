/**
 * @fileOverview Box module.
 * @change
 	#1 by prcjack Creates file.
	#2 by prcjack @2014/02/21 Fix doLayout() method bug: add available check of layout.
	#3 by prcjack @2014/05/29 Merged "gui.box.body".
	#4 by prcjack @2014/09/24 Add defer for body render.
 */
orderjs.define("gui.box.Box",["lib.dom.engine","gui.engine","gui.layout.engine"],function(){rl.gui.box.Box=rl.createClass({parent:rl.gui.ContainerBase,construct:function(t){rl.isPrototyping(arguments[0])||(rl.gui.box.Box.parent.call(this,t),this.items=[],this._namedItemsStore={},this.dw=new rl.dom.DomWrap,this.autoRenderOnReady&&rl.onReady(Function.bind(this.render,this)))},members:{isBodyCtn:!1,boxDomProvider:null,autoRenderOnReady:!1,iniStyle:null,autoLayout:!0,layoutType:rl.gui.layout.FlowLayout,layoutConfig:null,_layoutAssigned:!1,render:function(t){return this._rendered?this:(t=this.getRenderTarget(t),this.initLayoutEle(t),this.iniStyle&&this.dw.setStyle(this.iniStyle),this._rendered=!0,this.fireEvent("render"),this)},initLayoutEle:function(t){var i=rl.getDom(this.boxDomProvider);this.isBodyCtn?i=document.body:(!i&&rl.isElement(t)&&(i=document.createElement("div"),i.style.height="100%"),t.appendChild(i)),rl.isElement(i)&&(this.dw.setTarget(i),this.initLayout())},initLayout:function(){if(this._layoutAssigned)return this;var t=this.layout=new this.layoutType(this.layoutConfig);return rl.isFunction(t.initContainer)&&t.initContainer(this,this.autoLayout),this._layoutAssigned=!0,this.fireEvent("layoutready"),this},add:function(){try{this.layout.addLayoutComponent.apply(this.layout,arguments),this.doLayout()}catch(t){return!1}return rl.gui.box.Box.parent.prototype.add.apply(this,arguments)},afterAdd:function(t){t.owner=this},remove:function(){try{this.layout.removeLayoutComponent.apply(this.layout,arguments),this.doLayout()}catch(t){return!1}return rl.gui.box.Box.parent.prototype.remove.apply(this,arguments)},afterRemove:function(t){t.owner=null},batchAdd:function(t){return this.beginLayout(),Array.each(this.add,t,this),this.endLayout(),this},beginLayout:function(){this.layouting=!0},endLayout:function(){this.layouting=!1,this.doLayout()},cancelLayout:function(){this.layouting=!1},doLayout:function(){if(this.layouting)return this;var t=this.layout;return t?(rl.isFunction(t.layoutContainer)&&t.layoutContainer(),this.fireEvent("layout"),this):this},getWidth:function(){return this.dw.getWidth()},getHeight:function(){return this.dw.getHeight()},setSize:function(t,i){var e=this.width,n=this.height,o=!1;return t>0&&(this.width=t,this.dw.setWidth(t),this.fireEvent("sizechange","width",t,e),o=!0),i>0&&(this.height=i,this.dw.setHeight(i),this.fireEvent("sizechange","height",i,n),o=!0),o&&this.doLayout(),this},setHeight:function(t){return this.height=t,this.setSize(void 0,t),this},setWidth:function(t){return this.setSize(t),this},toString:function(){return"[object rl.gui.box.Box]"}}}),rl.gui.ctype2Classes.add("box",rl.gui.box.Box),function(){rl.body=new rl.gui.box.Box({isBodyCtn:!0,autoRenderOnReady:!1,layoutType:rl.gui.layout.BorderLayout,getWidth:function(){return rl.dom.viewport.getWidth()},getHeight:function(){return rl.dom.viewport.getHeight()},hndWindowResize:function(){return rl.body.doLayout()}}),rl.dom.viewport.on("resize",rl.body.hndWindowResize),rl.layoutBody=function(t){rl.body.layoutConfig=t,rl.onReady(function(){rl.defer(rl.body.render,rl.body)})}}()});