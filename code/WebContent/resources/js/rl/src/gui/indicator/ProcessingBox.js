orderjs.define("gui.indicator.ProcessingBox",["gui.engine","gui.indicator.IndicatorBase","gui.indicator.MsgBox","gui.indicator.AutoUpdateProgressBar"],function(){var r=rl.getG11nSource("rl.gui.indicator.msgBoxMgr")||{};rl.gui.indicator.ProcessingBox=rl.createClass({parent:rl.gui.ComponentBase,construct:function(r){return rl.isPrototyping(arguments[0])?void 0:(rl.gui.indicator.ProcessingBox.parent.call(this,r),rl.ext(this,r),this.initialize(),this)},members:{msg:"",msgReadErr:r.msgReadErr||"Process failed!",msgComplete:r.msgComplete||"Process success!",progressUrl:"",dataUpdateInterval:1,progressRead:null,autoRenderOnReady:!0,modal:!0,progressBarOptions:null,initialize:function(){rl.isNonNullStr(this.id)||(this.id=this.autoId()),this.msgWrapperId=this.id+"_msgWrapper",this.initMsgBox(),this.initProgressBar(),this.autoRenderOnReady&&rl.onReady(Function.bind(this.render,this))},render:function(){return this.msgBox.render(),this.setMsg(this.msg),this._rendered=!0,this.fireEvent("render"),this},initMsgBox:function(){var r=this.msgBox;r||(r=this.msgBox=this.createMsgBox())},createMsgBox:function(){{var r=rl.gui.indicator.msgBoxMgr;this.id}return o={msg:'<div style="width:300px; padding-bottom:1em;" id="'+this.msgWrapperId+'"></div>',modal:this.modal,autoRenderOnReady:!1,iniVisible:!1,icon:"info",buttons:[{text:r.okButtonText,action:null}]},new rl.gui.indicator.MsgBox(o)},initProgressBar:function(){var r=this.msgBox,t=this.progressBar;t||(t=this.progressBar=this.createProgressBar()),r.on("render",this.hndMsgBoxRender,this);var s=t.dataReader;s.on("complete",this.hndReadComplete,this),s.on("read",this.hndProgressUpdate,this),s.on("readerror",this.hndReadProgressError,this)},createProgressBar:function(){return new rl.gui.indicator.AutoUpdateProgressBar({read:this.progressRead,dataUrl:this.progressUrl,updateInterval:this.dataUpdateInterval||1,autoRenderOnReady:!1,renderTarget:this.msgBox.wid})},hndProgressUpdate:function(){var r=this.progressBar,t=this[r.completed?"msgComplete":"msg"];this.setMsg(t)},hndReadProgressError:function(){this.setMsg(this.msg)},hndReadComplete:function(){var r=this.msgBox,t=r.getButton(1);t&&(t.disabled=!1),this.fireEvent("complete")},hndMsgBoxRender:function(){var r=this.progressBar;r.render()},setMsg:function(r){if(rl.isNonNullStr(r)){var t=this.progressBar,s=t.dataReader.data||{},e=this.msgBox,i={total:s.total,current:s.current,progress:t.progress+"%"};rl.$(this.msgWrapperId).setInnerHTML(rl.format(r,i)),e.useShim&&e.updateShimView()}return this},show:function(r,t){var s=this.progressBar,e=this.msgBox,i=e.buttons,o=i[0],n=e.getButton(1);return e.show(),o&&(n.disabled=!0,o.action=t),s.startReading(),this},hide:function(){return this.msgBox.hide(),this},toString:function(){return"[object rl.gui.indicator.ProcessingBox]"}}})});