var Validator={Require:/.+/,Email:/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,Phone:/^((\(\d{3}\))|(\d{3}\-))?(\(0\d{2,3}\)|0\d{2,3}-)?[1-9]\d{6,7}$/,Mobile:/^((\(\d{3}\))|(\d{3}\-))?1\d{10}$/,Url:/^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/,IdCard:/^\d{15}(\d{2}[A-Za-z0-9])?$/,Currency:/^\d+(\.\d+)?$/,Number:/^\d+$/,Zip:/^[1-9]\d{5}$/,QQ:/^[1-9]\d{4,8}$/,Integer:/^[-\+]?\d+$/,Double:/^[-\+]?\d+(\.\d+)?$/,English:/^[A-Za-z]+$/,Chinese:/^[\u0391-\uFFE5]+$/,UnSafe:/^(([A-Z]*|[a-z]*|\d*|[-_\~!@#\$%\^&\*\.\(\)\[\]\{\}<>\?\\\/\'\"]*)|.{0,5})$|\s/,Ip:/^(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])$/,IsSafe:function(e){return!this.UnSafe.test(e)},SafeString:"this.IsSafe(value)",Limit:"this.limit(value.length,getAttribute('min'),  getAttribute('max'))",LimitB:"this.limit(this.LenB(value), getAttribute('min'), getAttribute('max'))",Date:"this.IsDate(value, getAttribute('min'), getAttribute('format'))",Repeat:"value == document.getElementsByName(getAttribute('to'))[0].value",Range:"!isNaN(value)&&parseInt(getAttribute('min')) < parseInt(value) && parseInt(value) < parseInt(getAttribute('max'))",Compare:"this.compare(value,getAttribute('operator'),getAttribute('to'))",Custom:"this.Exec(value, getAttribute('regexp'))",Group:"this.MustChecked(getAttribute('name'), getAttribute('min'), getAttribute('max'))",ErrorItem:[document.forms[0]],ErrorMessage:[(rl.getG11nSource("x:mti.Validator")||{}).vCauses||"Validate failed:\n"],defMsg:rl.ext({Require:"required",Chinese:"chinese only",English:"english only",Number:"number only",Integer:"integer only",Double:"double only",Email:"wrong email format",Url:"wrong url format",Phone:"wrong phone format",Mobile:"wrong mobile phone format",Currency:"wrong currency format",Zip:"wrong zip format",IdCard:"wrong ID card format",QQ:"wrong qq format",Date:"wrong date format",SafeString:"week passwork",Repeat:"wrong repeat",Compare:"wrong",Ip:"wrong ip format",Range:"exceed range",Limit:"exceed length",LimitB:"exceed length in bytes",Group:"choose at least one item",Custom:"wrong format"},(rl.getG11nSource("x:mti.Validator")||{}).defMsg),Validate:function(theForm,mode){var obj=theForm||event.srcElement,count=obj.elements.length;this.ErrorMessage.length=1,this.ErrorItem.length=1,this.ErrorItem[0]=obj;for(var i=0;count>i;i++)with(obj.elements[i]){if(obj.elements[i].disabled)continue;try{var _dataType=getAttribute("dataType")}catch(err){continue}if("object"==typeof _dataType||"undefined"==typeof this[_dataType])continue;if(this.ClearState(obj.elements[i]),"false"==getAttribute("require")&&""==value)continue;switch(value=value.trim(),_dataType){case"Date":case"Repeat":case"Range":case"Compare":case"Custom":case"Group":case"Limit":case"LimitB":case"SafeString":eval(this[_dataType])||this.AddError(i,this.getErrorMassage(_dataType,getAttribute("msg")));break;default:this[_dataType].test(value)||this.AddError(i,this.getErrorMassage(_dataType,getAttribute("msg")))}}if(this.ErrorMessage.length>1){mode=mode||1;var errCount=this.ErrorItem.length;switch(mode){case 2:for(var i=1;errCount>i;i++)this.ErrorItem[i].style.color="red";case 1:alert(this.ErrorMessage.join("\n")),this.ErrorItem[1].focus();break;case 3:for(var i=1;errCount>i;i++)try{var span=document.createElement("SPAN");span.id="__ErrorMessagePanel",span.style.color="red",span.className="rl_span_error",this.ErrorItem[i].parentNode.appendChild(span),span.innerHTML=this.ErrorMessage[i].replace(/\d+:/,"")}catch(e){alert(e.description)}this.ErrorItem[1].focus();break;default:alert(this.ErrorMessage.join("\n"))}return!1}return!0},getErrorMassage:function(e,t){var r=t||this.defMsg[e];return r},limit:function(e,t,r){return t=t||0,r=r||Number.MAX_VALUE,e>=t&&r>=e},LenB:function(e){return e.replace(/[^\x00-\xff]/g,"**").length},ClearState:function(elem){with(elem){"red"==style.color&&(style.color="");var lastNode=parentNode.childNodes[parentNode.childNodes.length-1];"__ErrorMessagePanel"==lastNode.id&&parentNode.removeChild(lastNode)}},AddError:function(e,t){this.ErrorItem[this.ErrorItem.length]=this.ErrorItem[0].elements[e],this.ErrorMessage[this.ErrorMessage.length]=this.ErrorMessage.length+":"+t},Exec:function(e,t){return new RegExp(t,"g").test(e)},compare:function(e,t,r){switch(t){case"NotEqual":return e!=r;case"GreaterThan":return e>r;case"GreaterThanEqual":return e>=r;case"LessThan":return r>e;case"LessThanEqual":return r>=e;default:return e==r}},MustChecked:function(e,t,r){var a=document.getElementsByName(e),n=0;t=t||1,r=r||a.length;for(var i=a.length-1;i>=0;i--)a[i].checked&&n++;return n>=t&&r>=n},IsDate:function(e,t){function r(e){return(30>e?"20":"19")+e|0}t=t||"ymd";var a,n,i,o;switch(t){case"ymd":if(a=e.match(new RegExp("^((\\d{4})|(\\d{2}))([-./])(\\d{1,2})\\4(\\d{1,2})$")),null==a)return!1;o=a[6],i=a[5]--,n=4==a[2].length?a[2]:r(parseInt(a[3],10));break;case"dmy":if(a=e.match(new RegExp("^(\\d{1,2})([-./])(\\d{1,2})\\2((\\d{4})|(\\d{2}))$")),null==a)return!1;o=a[1],i=a[3]--,n=4==a[5].length?a[5]:r(parseInt(a[6],10))}if(!parseInt(i))return!1;i=12==i?0:i;var s=new Date(n,i,o);return"object"==typeof s&&n==s.getFullYear()&&i==s.getMonth()&&o==s.getDate()}};rl.createNamespace("rlx.mti",{validate:function(e,t){var r=Array.slice(arguments);return rl.isNonNullStr(e)&&(r[0]=rl.getDom(e)||document.forms[e]),rl.isDefined(t)||(r[1]=3),Validator.Validate.apply(Validator,r)}});